function r(e) { this.initialize(e) } function i(e) { this.initialize(e) } function s(e) { this.initialize(e) } function u(e) { this.initialize(e) } function f() { var n = this; n.canvas = {}, n.stage = {}, n.loader = {}, n.manifest = [], n.fpsLabel = {}, n.assetsXML = {}, n.resCache = [], n.enemys = [], n.MapCTT = new gg7.gg6, n.footPrintCTT = new gg7.gg6, n.MapCTT.adcg1(n.footPrintCTT), n.toolBarCTT = new gg7.gg6, n.levelPanelCTT = new gg7.gg6, n.init = function () { n.canvas = document.getElementById("gameCanvas"), n.stage = new gg7.Stage(n.canvas), n.initLoader(), e.loadXml("assets.xml", n.configXmlLoaded), n.stage.adcg1(n.MapCTT, n.toolBarCTT, n.levelPanelCTT), n.messageField = new gg7.Text("Loading", "bold 24px Arial", "#FFFFFF"), n.messageField.maxWidth = 1e3, n.messageField.textAlign = "center", n.messageField.x = n.canvas.width / 2, n.messageField.y = n.canvas.height / 2, n.stage.adcg1(n.messageField), n.fpsLabel = new gg7.Text("-- FPS", "bold 24px Arial", "#fff"), n.fpsLabel.x = 840, n.fpsLabel.y = 20, n.fpsLabel.alpha = .8, n.stage.adcg1(n.fpsLabel), n.auLabel = new gg7.Text("create by \u5f53\u8010\u7279", "bold 24px Arial", "black"), n.auLabel.x = 640, n.auLabel.y = 600, n.auLabel.alpha = .8, n.stage.adcg1(n.auLabel), gg7.gg2.setFPS(60), gg7.gg2.addListener(n) }, n.initToolBar = function () { var e = new t.getBitmap("selectLevel"), r = new t.getBitmap("restart"); e.x = 70, e.y = 560, r.x = 170, r.y = 574, e.onClick = function () { n.curtain.close(function () { for (var e = 0; e < n.MapCTT.children.length; e++) gg7.gg2.gg3(n.MapCTT.children[e]); n.footPrintCTT.racgg22(), n.MapCTT.racgg22(), n.levelPanel.visible = !0, n.curtain.open() }) }, r.onClick = function () { n.curtain.close(function () { for (var e = 0; e < n.MapCTT.children.length; e++) gg7.gg2.gg3(n.MapCTT.children[e]); n.footPrintCTT.racgg22(), n.MapCTT.racgg22(), n.loadLevel(n.currentLevel), n.curtain.open() }) }, n.toolBarCTT.adcg1(e, r) }, n.initLoader = function () { n.manifest.length = 0, n.loader = new gg7.PreloadJS, n.loader.onComplete = n.handleComplete, n.loader.onFileLoad = n.handleFileLoaded }, n.configXmlLoaded = function (e) { n.assetsXML = e, n.addToLoaderQueue("player", "level", "map", "other", "enemy", "levelPanel") }, n.addToLoaderQueue = function () { for (var e = arguments.length, t = 0; t < e; t++) { var r = arguments[t]; $(n.assetsXML).find(arguments[t]).find("asset").each(function () { n.manifest.push({ src: "assets/" + r + "/" + $(this).attr("url"), id: $(this).attr("id") }), $(this).attr("configUrl") && n.manifest.push({ src: "assets/" + r + "/" + $(this).attr("configUrl"), id: $(this).attr("id") + "Config" }) }), n.loader.loadManifest(n.manifest), n.manifest = [] } }, n.handleComplete = function () { n.messageField.visible = !1, n.curtain = new v, n.stage.adcg1(n.curtain), n.loadLevelPanel(), n.initToolBar() }, n.loadLevelPanel = function () { n.levelPanel = new p, n.levelPanelCTT.adcg1(n.levelPanel) }, n.loadLevel = function (e) { n.enemys.length = 0; var e = JSON.parse(t.getRes("level" + e)), a = e.layers[0].data.length, f = e.tilesets[0].firstgid; n.mapData = []; for (var l = 0; l < 15; l++) n.mapData[l] = []; for (l = 0; l < a; l++) { var p = t.getBitmap(e.tilesets[0].name); p.gkk3 = new gg7.fcnaaf(e.tilewidth * ((e.layers[0].data[l] - f) % 4), e.tileheight * Math.floor((e.layers[0].data[l] - f) / 4), e.tilewidth, e.tileheight), p.x = e.tilewidth * (l % 15), p.y = e.tileheight * Math.floor(l / 15), n.MapCTT.adcg1(p), n.mapData[l % 15][Math.floor(l / 15)] = e.layers[0].data[l] < 5 ? 0 : 1 } n.MapCTT.adcg1(n.footPrintCTT), n.astar = new o(n.mapData), a = e.tilesets[1].firstgid; for (l = 0; l < e.layers[1].data.length; l++) e.layers[1].data[l] !== 0 && (p = t.getBitmap(e.tilesets[1].name), p.gkk3 = new gg7.fcnaaf(e.tilewidth * ((e.layers[1].data[l] - a) % 4), e.tileheight * Math.floor((e.layers[1].data[l] - a) / 4), e.tilewidth, e.tileheight), p.x = e.tilewidth * (l % 15), p.y = e.tileheight * Math.floor(l / 15), n.MapCTT.adcg1(p)); n.box = new r({ x: e.box.x, y: e.box.y }), n.MapCTT.adcg1(n.box); for (l = 0; l < e.smallCandle.length; l++) a = new i({ x: e.smallCandle[l].x, y: e.smallCandle[l].y }), n.MapCTT.adcg1(a); for (l = 0; l < e.smallCandle.length; l++) a = new i({ x: e.smallCandle[l].x, y: e.smallCandle[l].y }), n.MapCTT.adcg1(a); for (l = 0; l < e.bigCandle.length; l++) a = new s({ x: e.bigCandle[l].x, y: e.bigCandle[l].y }), n.MapCTT.adcg1(a); n.exit = new c({ x: e.exit.x, y: e.exit.y }), n.MapCTT.adcg1(n.exit); for (l = 0; l < e.enemy.length; l++) a = new h(e.enemy[l].name, new Vector2(e.enemy[l].x, e.enemy[l].y)), a.pathBak = _(e.enemy[l].path).clone(), a.path = _(e.enemy[l].path).clone(), n.MapCTT.adcg1(a), n.enemys.push(a); n.player = new u(new Vector2(e.player.x, e.player.y)), n.MapCTT.adcg1(n.player), n.MapCTT.onClick = function () { n.footPrintCTT.racgg22(); var e = n.astar.getPath(n.player.currentCell.x, n.player.currentCell.y, parseInt(n.stage.mouseX / 64), parseInt(n.stage.mouseY / 64)); if (e.length > 0) { e.shift(); for (var r = 1; r < e.length; r++) { var i = e[r][0] - e[r - 1][0], s = e[r][1] - e[r - 1][1], o = t.getBitmap("footprint"); o.regX = 16, o.regY = 16, o.x = e[r][0] * 64 + 32, o.y = e[r][1] * 64 + 32, i > 0 && s === 0 && (o.rotation = 90), i === 0 && s > 0 && (o.rotation = 180), i < 0 && s === 0 && (o.rotation = 270), n.footPrintCTT.adcg1(o) } n.player.path = e } }, n.winPP = t.getBitmap("levelcomplete"), n.winPP.regX = n.winPP.image.width / 2, n.winPP.regY = n.winPP.image.height / 2, n.winPP.scaleX = 0, n.winPP.scaleY = 0, n.winPP.x = n.canvas.width / 2, n.winPP.y = n.canvas.height / 2, n.losePP = t.getBitmap("levelfailed"), n.losePP.regX = n.losePP.image.width / 2, n.losePP.regY = n.losePP.image.height / 2, n.losePP.scaleX = 0, n.losePP.scaleY = 0, n.losePP.x = n.canvas.width / 2, n.losePP.y = n.canvas.height / 2, n.MapCTT.adcg1(n.winPP, n.losePP) }, n.handleFileLoaded = function (e) { e.type !== "sound" && t.addRes(e.id, e.result), n.messageField.text = "Loading " + (n.loader.progress * 100 | 0) + "%" }, n.showWin = function () { gg7.gkk4.get(n.winPP).to({ scaleX: 1, scaleY: 1 }, 600, gg7.Ease.backOut) }, n.showLose = function () { gg7.gkk4.get(n.losePP).to({ scaleX: 1, scaleY: 1 }, 600, gg7.Ease.backOut) }, n.tick = function () { for (var e = 0; e < n.enemys.length; e++) { if (n.enemys[e].name == "knight" && n.enemys[e].attackCD) { var t = new Vector2(0, 0), r = 0; n.enemys[e].dir == 1 && (t.y = -1, r = n.enemys[e].currentCell.y), n.enemys[e].dir == 2 && (t.x = 1, r = 15 - n.enemys[e].currentCell.x - 1), n.enemys[e].dir == 3 && (t.y = 1, r = 10 - n.enemys[e].currentCell.y - 1), n.enemys[e].dir == 4 && (t.x = -1, r = n.enemys[e].currentCell.x); for (var i = 0; i < r; i++) { var s = n.enemys[e].currentCell.add(new Vector2(t.x * (i + 1), t.y * (i + 1))); if (n.mapData[s.x][s.y] == 1) break; s.x == n.player.currentCell.x && s.y == n.player.currentCell.y && n.enemys[e].attackCD && (s = new m(new Vector2(n.enemys[e].x, n.enemys[e].y), n.enemys[e].dir), n.MapCTT.adcg1(s), n.enemys[e].attack(), n.enemys[e].attackCD = !1) } } t = n.player.aabb.GetIntersectionDepth(n.enemys[e].aabb); if (t.x != 0 || t.y != 0) gg7.gg2.gg3(n.player), gg7.gg2.gg3(n.enemys[e]), n.enemys[e].speed = 0, n.enemys[e].win(), n.showLose(), n.player.lose() } n.fpsLabel.text = Math.round(gg7.gg2.getMeasuredFPS()) + " FPS", n.stage.adcg1(a.fpsLabel), n.stage.update() } } function l(e, t, n, r) { this.initialize(e, t, n, r) } function c(e) { this.initialize(e) } function h(e, t) { this.initialize(e, t) } function p() { this.initialize() } function d(e, t) { this.initialize(e, t) } function v() { this.initialize() } function m(e, t) { this.initialize(e, t) } this.gg7 = this.gg7 || {}, function () { var e = function () { throw "UID cannot be instantiated" }; e._nextID = 0, e.get = function () { return e._nextID++ }, gg7.UID = e } (), this.gg7 = this.gg7 || {}, function () { var e = function () { throw "gg2 cannot be instantiated." }; e.useRAF = null, e._listeners = null, e._pauseable = null, e._paused = !1, e._inited = !1, e._startTime = 0, e._pausedTime = 0, e._ticks = 0, e._pausedTicks = 0, e._interval = 50, e._lastTime = 0, e._times = null, e._tickTimes = null, e._rafActive = !1, e._timeoutID = null, e.addListener = function (t, n) { t != null && (e._inited || e.init(), e.gg3(t), e._pauseable[e._listeners.length] = n == null ? !0 : n, e._listeners.push(t)) }, e.init = function () { e._inited = !0, e._times = [], e._tickTimes = [], e._pauseable = [], e._listeners = [], e._times.push(e._lastTime = e._startTime = e._getTime()), e.setInterval(e._interval) }, e.gg3 = function (t) { var n = e._listeners; n && (t = n.indexOf(t), t != -1 && (n.splice(t, 1), e._pauseable.splice(t, 1))) }, e.removeAllListeners = function () { e._listeners = [], e._pauseable = [] }, e.setInterval = function (t) { e._interval = t, e._inited && e._setupTick() }, e.getInterval = function () { return e._interval }, e.setFPS = function (t) { e.setInterval(1e3 / t) }, e.getFPS = function () { return 1e3 / e._interval }, e.getMeasuredFPS = function (t) { return e._times.length < 2 ? -1 : (t == null && (t = e.getFPS() | 0), t = Math.min(e._times.length - 1, t), 1e3 / ((e._times[0] - e._times[t]) / t)) }, e.setPaused = function (t) { e._paused = t }, e.getPaused = function () { return e._paused }, e.getTime = function (t) { return e._getTime() - e._startTime - (t ? e._pausedTime : 0) }, e.getTicks = function (t) { return e._ticks - (t ? e._pausedTicks : 0) }, e._handleAF = function () { e._rafActive = !1, e._setupTick(), e._getTime() - e._lastTime >= (e._interval - 1) * .97 && e._tick() }, e._handleTimeout = function () { e.timeoutID = null, e._setupTick(), e._tick() }, e._setupTick = function () { if (!e._rafActive && e.timeoutID == null) { if (e.useRAF) { var t = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame; if (t) { t(e._handleAF), e._rafActive = !0; return } } e.timeoutID = setTimeout(e._handleTimeout, e._interval) } }, e._tick = function () { var t = e._getTime(); e._ticks++; var n = t - e._lastTime, r = e._paused; r && (e._pausedTicks++, e._pausedTime += n), e._lastTime = t; for (var i = e._pauseable, s = e._listeners.slice(), o = s ? s.length : 0, u = 0; u < o; u++) { var a = s[u]; a == null || r && i[u] || (a.tick ? a.tick(n, r) : a instanceof Function && a(n, r)) } for (e._tickTimes.unshift(e._getTime() - t); e._tickTimes.length > 100; ) e._tickTimes.pop(); for (e._times.unshift(t); e._times.length > 100; ) e._times.pop() }; var t = window.performance && (performance.now || performance.mozNow || performance.msNow || performance.oNow || performance.webkitNow); e._getTime = function () { return t && t.call(performance) || +(new Date) }, gg7.gg2 = e } (), this.gg7 = this.gg7 || {}, function () { var e = function (e, t, n, r, i, s, o, u, a) { this.initialize(e, t, n, r, i, s, o, u, a) }, t = e.prototype; t.stageX = 0, t.stageY = 0, t.rawX = 0, t.rawY = 0, t.type = null, t.nativeEvent = null, t.onMouseMove = null, t.onMouseUp = null, t.target = null, t.pointerID = 0, t.primary = !1, t.initialize = function (e, t, n, r, i, s, o, u, a) { this.type = e, this.stageX = t, this.stageY = n, this.target = r, this.nativeEvent = i, this.pointerID = s, this.primary = o, this.rawX = u == null ? t : u, this.rawY = a == null ? n : a }, t.clone = function () { return new e(this.type, this.stageX, this.stageY, this.target, this.nativeEvent, this.pointerID, this.primary, this.rawX, this.rawY) }, t.toString = function () { return "[MouseEvent (type=" + this.type + " stageX=" + this.stageX + " stageY=" + this.stageY + ")]" }, gg7.MouseEvent = e } (), this.gg7 = this.gg7 || {}, function () { var e = function (e, t, n, r, i, s) { this.initialize(e, t, n, r, i, s) }, t = e.prototype; e.identity = null, e.DEG_TO_RAD = Math.PI / 180, t.a = 1, t.b = 0, t.c = 0, t.d = 1, t.tx = 0, t.ty = 0, t.alpha = 1, t.shadow = null, t.compositeOperation = null, t.initialize = function (e, t, n, r, i, s) { return e != null && (this.a = e), this.b = t || 0, this.c = n || 0, r != null && (this.d = r), this.tx = i || 0, this.ty = s || 0, this }, t.prepend = function (e, t, n, r, i, s) { var o = this.tx; if (e != 1 || t != 0 || n != 0 || r != 1) { var u = this.a, a = this.c; this.a = u * e + this.b * n, this.b = u * t + this.b * r, this.c = a * e + this.d * n, this.d = a * t + this.d * r } return this.tx = o * e + this.ty * n + i, this.ty = o * t + this.ty * r + s, this }, t.append = function (e, t, n, r, i, s) { var o = this.a, u = this.b, a = this.c, f = this.d; return this.a = e * o + t * a, this.b = e * u + t * f, this.c = n * o + r * a, this.d = n * u + r * f, this.tx = i * o + s * a + this.tx, this.ty = i * u + s * f + this.ty, this }, t.prependMatrix = function (e) { return this.prepend(e.a, e.b, e.c, e.d, e.tx, e.ty), this.prependProperties(e.alpha, e.shadow, e.compositeOperation), this }, t.appendMatrix = function (e) { return this.append(e.a, e.b, e.c, e.d, e.tx, e.ty), this.appendProperties(e.alpha, e.shadow, e.compositeOperation), this }, t.prependTransform = function (t, n, r, i, s, o, u, a, f) { if (s % 360) var l = s * e.DEG_TO_RAD, s = Math.cos(l), l = Math.sin(l); else s = 1, l = 0; if (a || f) this.tx -= a, this.ty -= f; return o || u ? (o *= e.DEG_TO_RAD, u *= e.DEG_TO_RAD, this.prepend(s * r, l * r, -l * i, s * i, 0, 0), this.prepend(Math.cos(u), Math.sin(u), -Math.sin(o), Math.cos(o), t, n)) : this.prepend(s * r, l * r, -l * i, s * i, t, n), this }, t.appendTransform = function (t, n, r, i, s, o, u, a, f) { if (s % 360) var l = s * e.DEG_TO_RAD, s = Math.cos(l), l = Math.sin(l); else s = 1, l = 0; o || u ? (o *= e.DEG_TO_RAD, u *= e.DEG_TO_RAD, this.append(Math.cos(u), Math.sin(u), -Math.sin(o), Math.cos(o), t, n), this.append(s * r, l * r, -l * i, s * i, 0, 0)) : this.append(s * r, l * r, -l * i, s * i, t, n); if (a || f) this.tx -= a * this.a + f * this.c, this.ty -= a * this.b + f * this.d; return this }, t.rotate = function (e) { var t = Math.cos(e), e = Math.sin(e), n = this.a, r = this.c, i = this.tx; return this.a = n * t - this.b * e, this.b = n * e + this.b * t, this.c = r * t - this.d * e, this.d = r * e + this.d * t, this.tx = i * t - this.ty * e, this.ty = i * e + this.ty * t, this }, t.skew = function (t, n) { return t *= e.DEG_TO_RAD, n *= e.DEG_TO_RAD, this.append(Math.cos(n), Math.sin(n), -Math.sin(t), Math.cos(t), 0, 0), this }, t.scale = function (e, t) { return this.a *= e, this.d *= t, this.tx *= e, this.ty *= t, this }, t.translate = function (e, t) { return this.tx += e, this.ty += t, this }, t.identity = function () { return this.alpha = this.a = this.d = 1, this.b = this.c = this.tx = this.ty = 0, this.shadow = this.compositeOperation = null, this }, t.invert = function () { var e = this.a, t = this.b, n = this.c, r = this.d, i = this.tx, s = e * r - t * n; return this.a = r / s, this.b = -t / s, this.c = -n / s, this.d = e / s, this.tx = (n * this.ty - r * i) / s, this.ty = -(e * this.ty - t * i) / s, this }, t.isIdentity = function () { return this.tx == 0 && this.ty == 0 && this.a == 1 && this.b == 0 && this.c == 0 && this.d == 1 }, t.decompose = function (t) { t == null && (t = {}), t.x = this.tx, t.y = this.ty, t.scaleX = Math.sqrt(this.a * this.a + this.b * this.b), t.scaleY = Math.sqrt(this.c * this.c + this.d * this.d); var n = Math.atan2(-this.c, this.d), r = Math.atan2(this.b, this.a); return n == r ? (t.rotation = r / e.DEG_TO_RAD, this.a < 0 && this.d >= 0 && (t.rotation += t.rotation <= 0 ? 180 : -180), t.skewX = t.skewY = 0) : (t.skewX = n / e.DEG_TO_RAD, t.skewY = r / e.DEG_TO_RAD), t }, t.reinitialize = function (e, t, n, r, i, s, o, u, a) { return this.initialize(e, t, n, r, i, s), this.alpha = o || 1, this.shadow = u, this.compositeOperation = a, this }, t.appendProperties = function (e, t, n) { return this.alpha *= e, this.shadow = t || this.shadow, this.compositeOperation = n || this.compositeOperation, this }, t.prependProperties = function (e, t, n) { return this.alpha *= e, this.shadow = this.shadow || t, this.compositeOperation = this.compositeOperation || n, this }, t.clone = function () { var t = new e(this.a, this.b, this.c, this.d, this.tx, this.ty); return t.shadow = this.shadow, t.alpha = this.alpha, t.compositeOperation = this.compositeOperation, t }, t.toString = function () { return "[Matrix2D (a=" + this.a + " b=" + this.b + " c=" + this.c + " d=" + this.d + " tx=" + this.tx + " ty=" + this.ty + ")]" }, e.identity = new e(1, 0, 0, 1, 0, 0), gg7.Matrix2D = e } (), this.gg7 = this.gg7 || {}, function () { var e = function (e, t) { this.initialize(e, t) }, t = e.prototype; t.x = 0, t.y = 0, t.initialize = function (e, t) { this.x = e == null ? 0 : e, this.y = t == null ? 0 : t }, t.clone = function () { return new e(this.x, this.y) }, t.toString = function () { return "[Point (x=" + this.x + " y=" + this.y + ")]" }, gg7.Point = e } (), this.gg7 = this.gg7 || {}, function () { var e = function (e, t, n, r) { this.initialize(e, t, n, r) }, t = e.prototype; t.x = 0, t.y = 0, t.width = 0, t.height = 0, t.initialize = function (e, t, n, r) { this.x = e == null ? 0 : e, this.y = t == null ? 0 : t, this.width = n == null ? 0 : n, this.height = r == null ? 0 : r }, t.clone = function () { return new e(this.x, this.y, this.width, this.height) }, t.toString = function () { return "[fcnaaf (x=" + this.x + " y=" + this.y + " width=" + this.width + " height=" + this.height + ")]" }, gg7.fcnaaf = e } (), this.gg7 = this.gg7 || {}, function () { var e = function (e, t, n, r) { this.initialize(e, t, n, r) }, t = e.prototype; e.identity = null, t.color = null, t.offsetX = 0, t.offsetY = 0, t.blur = 0, t.initialize = function (e, t, n, r) { this.color = e, this.offsetX = t, this.offsetY = n, this.blur = r }, t.toString = function () { return "[Shadow]" }, t.clone = function () { return new e(this.color, this.offsetX, this.offsetY, this.blur) }, e.identity = new e("transparent", 0, 0, 0), gg7.Shadow = e } (), this.gg7 = this.gg7 || {}, function () { var e = function (e) { this.initialize(e) }, t = e.prototype; t.complete = !0, t.onComplete = null, t._animations = null, t._frames = null, t._images = null, t._data = null, t._loadCount = 0, t._frameHeight = 0, t._frameWidth = 0, t._numFrames = 0, t._regX = 0, t._regY = 0, t.initialize = function (e) { var t, n, r; if (e != null) { if (e.images && (n = e.images.length) > 0) { r = this._images = []; for (t = 0; t < n; t++) { var i = e.images[t]; if (typeof i == "string") { var s = i, i = new Image; i.src = s } r.push(i), !i.getContext && !i.complete && (this._loadCount++, this.complete = !1, function (e) { i.onload = function () { e._handleImageLoad() } } (this)) } } if (e.frames != null) if (e.frames instanceof Array) { this._frames = [], r = e.frames; for (t = 0, n = r.length; t < n; t++) s = r[t], this._frames.push({ image: this._images[s[4] ? s[4] : 0], rect: new gg7.fcnaaf(s[0], s[1], s[2], s[3]), regX: s[5] || 0, regY: s[6] || 0 }) } else n = e.frames, this._frameWidth = n.width, this._frameHeight = n.height, this._regX = n.regX || 0, this._regY = n.regY || 0, this._numFrames = n.count, this._loadCount == 0 && this._calculateFrames(); if ((n = e.animations) != null) { this._animations = [], this._data = {}; for (var o in n) { e = { name: o }, s = n[o]; if (isNaN(s)) if (s instanceof Array) { e.frequency = s[3], e.next = s[2], r = e.frames = []; for (t = s[0]; t <= s[1]; t++) r.push(t) } else e.frequency = s.frequency, e.next = s.next, t = s.frames, r = e.frames = isNaN(t) ? t.slice(0) : [t]; else r = e.frames = [s]; e.next = r.length < 2 || e.next == 0 ? null : e.next == null || e.next == 1 ? o : e.next, e.frequency || (e.frequency = 1), this._animations.push(o), this._data[o] = e } } } }, t.getNumFrames = function (e) { return e == null ? this._frames ? this._frames.length : this._numFrames : (e = this._data[e], e == null ? 0 : e.frames.length) }, t.getAnimations = function () { return this._animations.slice(0) }, t.getAnimation = function (e) { return this._data[e] }, t.getFrame = function (e) { return this.complete && this._frames && (frame = this._frames[e]) ? frame : null }, t.toString = function () { return "[gg5]" }, t.clone = function () { var t = new e; return t.complete = this.complete, t._animations = this._animations, t._frames = this._frames, t._images = this._images, t._data = this._data, t._frameHeight = this._frameHeight, t._frameWidth = this._frameWidth, t._numFrames = this._numFrames, t._loadCount = this._loadCount, t }, t._handleImageLoad = function () { --this._loadCount == 0 && (this._calculateFrames(), this.complete = !0, this.onComplete && this.onComplete()) }, t._calculateFrames = function () { if (!this._frames && this._frameWidth != 0) { this._frames = []; for (var e = 0, t = this._frameWidth, n = this._frameHeight, r = 0, i = this._images; r < i.length; r++) { for (var s = i[r], o = (s.width + 1) / t | 0, u = (s.height + 1) / n | 0, u = this._numFrames > 0 ? Math.min(this._numFrames - e, o * u) : o * u, a = 0; a < u; a++) this._frames.push({ image: s, rect: new gg7.fcnaaf(a % o * t, (a / o | 0) * n, t, n), regX: this._regX, regY: this._regY }); e += u } this._numFrames = e } }, gg7.gg5 = e } (), this.gg7 = this.gg7 || {}, function () { function e(e, t, n) { this.f = e, this.params = t, this.path = n == null ? !0 : n } e.prototype.exec = function (e) { this.f.apply(e, this.params) }; var t = function () { this.initialize() }, n = t.prototype; t.getRGB = function (e, t, n, r) { return e != null && n == null && (r = t, n = e & 255, t = e >> 8 & 255, e = e >> 16 & 255), r == null ? "rgb(" + e + "," + t + "," + n + ")" : "rgba(" + e + "," + t + "," + n + "," + r + ")" }, t.getHSL = function (e, t, n, r) { return r == null ? "hsl(" + e % 360 + "," + t + "%," + n + "%)" : "hsla(" + e % 360 + "," + t + "%," + n + "%," + r + ")" }, t.BASE_64 = { A: 0, B: 1, C: 2, D: 3, E: 4, F: 5, G: 6, H: 7, I: 8, J: 9, K: 10, L: 11, M: 12, N: 13, O: 14, P: 15, Q: 16, R: 17, S: 18, T: 19, U: 20, V: 21, W: 22, X: 23, Y: 24, Z: 25, a: 26, b: 27, c: 28, d: 29, e: 30, f: 31, g: 32, h: 33, i: 34, j: 35, k: 36, l: 37, m: 38, n: 39, o: 40, p: 41, q: 42, r: 43, s: 44, t: 45, u: 46, v: 47, w: 48, x: 49, y: 50, z: 51, 0: 52, 1: 53, 2: 54, 3: 55, 4: 56, 5: 57, 6: 58, 7: 59, 8: 60, 9: 61, "+": 62, "/": 63 }, t.STROKE_CAPS_MAP = ["butt", "round", "square"], t.STROKE_JOINTS_MAP = ["miter", "round", "bevel"], t._ctx = (gg7.createCanvas ? gg7.createCanvas() : document.createElement("canvas")).getContext("2d"), t.beginCmd = new e(t._ctx.beginPath, [], !1), t.fillCmd = new e(t._ctx.fill, [], !1), t.strokeCmd = new e(t._ctx.stroke, [], !1), n._strokeInstructions = null, n._strokeStyleInstructions = null, n._fillInstructions = null, n._instructions = null, n._oldInstructions = null, n._activeInstructions = null, n._active = !1, n._dirty = !1, n.initialize = function () { this.clear(), this._ctx = t._ctx }, n.draw = function (e) { this._dirty && this._updateInstructions(); for (var t = this._instructions, n = 0, r = t.length; n < r; n++) t[n].exec(e) }, n.drawAsPath = function (e) { this._dirty && this._updateInstructions(); for (var t, n = this._instructions, r = 0, i = n.length; r < i; r++) ((t = n[r]).path || r == 0) && t.exec(e) }, n.moveTo = function (t, n) { return this._activeInstructions.push(new e(this._ctx.moveTo, [t, n])), this }, n.lineTo = function (t, n) { return this._dirty = this._active = !0, this._activeInstructions.push(new e(this._ctx.lineTo, [t, n])), this }, n.arcTo = function (t, n, r, i, s) { return this._dirty = this._active = !0, this._activeInstructions.push(new e(this._ctx.arcTo, [t, n, r, i, s])), this }, n.arc = function (t, n, r, i, s, o) { return this._dirty = this._active = !0, o == null && (o = !1), this._activeInstructions.push(new e(this._ctx.arc, [t, n, r, i, s, o])), this }, n.quadraticCurveTo = function (t, n, r, i) { return this._dirty = this._active = !0, this._activeInstructions.push(new e(this._ctx.quadraticCurveTo, [t, n, r, i])), this }, n.bezierCurveTo = function (t, n, r, i, s, o) { return this._dirty = this._active = !0, this._activeInstructions.push(new e(this._ctx.bezierCurveTo, [t, n, r, i, s, o])), this }, n.rect = function (t, n, r, i) { return this._dirty = this._active = !0, this._activeInstructions.push(new e(this._ctx.rect, [t, n, r, i])), this }, n.closePath = function () { return this._active && (this._dirty = !0, this._activeInstructions.push(new e(this._ctx.closePath, []))), this }, n.clear = function () { return this._instructions = [], this._oldInstructions = [], this._activeInstructions = [], this._strokeStyleInstructions = this._strokeInstructions = this._fillInstructions = null, this._active = this._dirty = !1, this }, n.beginFill = function (t) { return this._active && this._newPath(), this._fillInstructions = t ? [new e(this._setProp, ["fillStyle", t], !1)] : null, this }, n.beginLinearGradientFill = function (t, n, r, i, s, o) { this._active && this._newPath(), r = this._ctx.createLinearGradient(r, i, s, o), i = 0; for (s = t.length; i < s; i++) r.addColorStop(n[i], t[i]); return this._fillInstructions = [new e(this._setProp, ["fillStyle", r], !1)], this }, n.beginRadialGradientFill = function (t, n, r, i, s, o, u, a) { this._active && this._newPath(), r = this._ctx.createRadialGradient(r, i, s, o, u, a), i = 0; for (s = t.length; i < s; i++) r.addColorStop(n[i], t[i]); return this._fillInstructions = [new e(this._setProp, ["fillStyle", r], !1)], this }, n.beginBitmapFill = function (t, n) { this._active && this._newPath(); var r = this._ctx.createPattern(t, n || ""); return this._fillInstructions = [new e(this._setProp, ["fillStyle", r], !1)], this }, n.endFill = function () { return this.beginFill() }, n.setStrokeStyle = function (n, r, i, s) { return this._active && this._newPath(), this._strokeStyleInstructions = [new e(this._setProp, ["lineWidth", n == null ? "1" : n], !1), new e(this._setProp, ["lineCap", r == null ? "butt" : isNaN(r) ? r : t.STROKE_CAPS_MAP[r]], !1), new e(this._setProp, ["lineJoin", i == null ? "miter" : isNaN(i) ? i : t.STROKE_JOINTS_MAP[i]], !1), new e(this._setProp, ["miterLimit", s == null ? "10" : s], !1)], this }, n.beginStroke = function (t) { return this._active && this._newPath(), this._strokeInstructions = t ? [new e(this._setProp, ["strokeStyle", t], !1)] : null, this }, n.beginLinearGradientStroke = function (t, n, r, i, s, o) { this._active && this._newPath(), r = this._ctx.createLinearGradient(r, i, s, o), i = 0; for (s = t.length; i < s; i++) r.addColorStop(n[i], t[i]); return this._strokeInstructions = [new e(this._setProp, ["strokeStyle", r], !1)], this }, n.beginRadialGradientStroke = function (t, n, r, i, s, o, u, a) { this._active && this._newPath(), r = this._ctx.createRadialGradient(r, i, s, o, u, a), i = 0; for (s = t.length; i < s; i++) r.addColorStop(n[i], t[i]); return this._strokeInstructions = [new e(this._setProp, ["strokeStyle", r], !1)], this }, n.beginBitmapStroke = function (t, n) { this._active && this._newPath(); var r = this._ctx.createPattern(t, n || ""); return this._strokeInstructions = [new e(this._setProp, ["strokeStyle", r], !1)], this }, n.endStroke = function () { return this.beginStroke(), this }, n.curveTo = n.quadraticCurveTo, n.drawRect = n.rect, n.drawRoundRect = function (e, t, n, r, i) { return this.drawRoundRectComplex(e, t, n, r, i, i, i, i), this }, n.drawRoundRectComplex = function (t, n, r, i, s, o, u, a) { var f = (r < i ? r : i) / 2, l = 0, c = 0, h = 0, p = 0; s < 0 && (s *= l = -1), s > f && (s = f), o < 0 && (o *= c = -1), o > f && (o = f), u < 0 && (u *= h = -1), u > f && (u = f), a < 0 && (a *= p = -1), a > f && (a = f), this._dirty = this._active = !0; var f = this._ctx.arcTo, d = this._ctx.lineTo; return this._activeInstructions.push(new e(this._ctx.moveTo, [t + r - o, n]), new e(f, [t + r + o * c, n - o * c, t + r, n + o, o]), new e(d, [t + r, n + i - u]), new e(f, [t + r + u * h, n + i + u * h, t + r - u, n + i, u]), new e(d, [t + a, n + i]), new e(f, [t - a * p, n + i + a * p, t, n + i - a, a]), new e(d, [t, n + s]), new e(f, [t - s * l, n - s * l, t + s, n, s]), new e(this._ctx.closePath)), this }, n.drawCircle = function (e, t, n) { return this.arc(e, t, n, 0, Math.PI * 2), this }, n.drawEllipse = function (t, n, r, i) { this._dirty = this._active = !0; var s = r / 2 * .5522848, o = i / 2 * .5522848, u = t + r, a = n + i, r = t + r / 2, i = n + i / 2; return this._activeInstructions.push(new e(this._ctx.moveTo, [t, i]), new e(this._ctx.bezierCurveTo, [t, i - o, r - s, n, r, n]), new e(this._ctx.bezierCurveTo, [r + s, n, u, i - o, u, i]), new e(this._ctx.bezierCurveTo, [u, i + o, r + s, a, r, a]), new e(this._ctx.bezierCurveTo, [r - s, a, t, i + o, t, i])), this }, n.drawPolyStar = function (t, n, r, i, s, o) { this._dirty = this._active = !0, s == null && (s = 0), s = 1 - s, o == null ? o = 0 : o /= 180 / Math.PI; var u = Math.PI / i; this._activeInstructions.push(new e(this._ctx.moveTo, [t + Math.cos(o) * r, n + Math.sin(o) * r])); for (var a = 0; a < i; a++) o += u, s != 1 && this._activeInstructions.push(new e(this._ctx.lineTo, [t + Math.cos(o) * r * s, n + Math.sin(o) * r * s])), o += u, this._activeInstructions.push(new e(this._ctx.lineTo, [t + Math.cos(o) * r, n + Math.sin(o) * r])); return this }, n.decodePath = function (e) { for (var n = [this.moveTo, this.lineTo, this.quadraticCurveTo, this.bezierCurveTo], r = [2, 2, 4, 6], i = 0, s = e.length, o = [], u = 0, a = 0, f = t.BASE_64; i < s; ) { var l = e.charAt(i), c = f[l], h = c >> 3, p = n[h]; if (!p || c & 3) throw "bad path data (@" + i + "): " + l; l = r[h], h || (u = a = 0), o.length = 0, i++, c = (c >> 2 & 1) + 2; for (h = 0; h < l; h++) { var d = f[e.charAt(i)], v = d >> 5 ? -1 : 1, d = (d & 31) << 6 | f[e.charAt(i + 1)]; c == 3 && (d = d << 6 | f[e.charAt(i + 2)]), d = v * d / 10, h % 2 ? u = d += u : a = d += a, o[h] = d, i += c } p.apply(this, o) } return this }, n.clone = function () { var e = new t; return e._instructions = this._instructions.slice(), e._activeInstructions = this._activeInstructions.slice(), e._oldInstructions = this._oldInstructions.slice(), this._fillInstructions && (e._fillInstructions = this._fillInstructions.slice()), this._strokeInstructions && (e._strokeInstructions = this._strokeInstructions.slice()), this._strokeStyleInstructions && (e._strokeStyleInstructions = this._strokeStyleInstructions.slice()), e._active = this._active, e._dirty = this._dirty, e.drawAsPath = this.drawAsPath, e }, n.toString = function () { return "[Graphics]" }, n.mt = n.moveTo, n.lt = n.lineTo, n.at = n.arcTo, n.bt = n.bezierCurveTo, n.qt = n.quadraticCurveTo, n.a = n.arc, n.r = n.rect, n.cp = n.closePath, n.c = n.clear, n.f = n.beginFill, n.lf = n.beginLinearGradientFill, n.rf = n.beginRadialGradientFill, n.bf = n.beginBitmapFill, n.ef = n.endFill, n.ss = n.setStrokeStyle, n.s = n.beginStroke, n.ls = n.beginLinearGradientStroke, n.rs = n.beginRadialGradientStroke, n.bs = n.beginBitmapStroke, n.es = n.endStroke, n.dr = n.drawRect, n.rr = n.drawRoundRect, n.rc = n.drawRoundRectComplex, n.dc = n.drawCircle, n.de = n.drawEllipse, n.dp = n.drawPolyStar, n.p = n.decodePath, n._updateInstructions = function () { this._instructions = this._oldInstructions.slice(), this._instructions.push(t.beginCmd), this._fillInstructions && this._instructions.push.apply(this._instructions, this._fillInstructions), this._strokeInstructions && (this._instructions.push.apply(this._instructions, this._strokeInstructions), this._strokeStyleInstructions && this._instructions.push.apply(this._instructions, this._strokeStyleInstructions)), this._instructions.push.apply(this._instructions, this._activeInstructions), this._fillInstructions && this._instructions.push(t.fillCmd), this._strokeInstructions && this._instructions.push(t.strokeCmd) }, n._getEllipseArc = function (t, n, r, i) { var s = r / 2 * .5522848, o = i / 2 * .5522848, u = t + r, a = n + i, r = t + r / 2, i = n + i / 2; return this._activeInstructions.push(new e(this._ctx.moveTo, [t, i]), new e(this._ctx.bezierCurveTo, [t, i - o, r - s, n, r, n]), new e(this._ctx.bezierCurveTo, [r + s, n, u, i - o, u, i]), new e(this._ctx.bezierCurveTo, [u, i + o, r + s, a, r, a]), new e(this._ctx.bezierCurveTo, [r - s, a, t, i + o, t, i])), this }, n._newPath = function () { this._dirty && this._updateInstructions(), this._oldInstructions = this._instructions, this._activeInstructions = [], this._active = this._dirty = !1 }, n._setProp = function (e, t) { this[e] = t }, gg7.Graphics = t } (), this.gg7 = this.gg7 || {}, function () {
    var e = function () { this.initialize() }, t = e.prototype; e.suppressCrossDomainErrors = !1, e._hitTestCanvas = gg7.createCanvas ? gg7.createCanvas() : document.createElement("canvas"), e._hitTestCanvas.width = e._hitTestCanvas.height = 1, e._hitTestContext = e._hitTestCanvas.getContext("2d"), e._nextCacheID = 1, t.alpha = 1, t.cacheCanvas = null, t.id = -1, t.mouseEnabled = !0, t.name = null, t.parent = null, t.regX = 0, t.regY = 0, t.rotation = 0, t.scaleX = 1, t.scaleY = 1, t.skewX = 0, t.skewY = 0, t.shadow = null, t.visible = !0, t.x = 0, t.y = 0, t.compositeOperation = null, t.snapToPixel = !1, t.onPress = null, t.onClick = null, t.onDoubleClick = null, t.onMouseOver = null, t.onMouseOut = null, t.onTick = null, t.filters = null, t.cacheID = 0, t.mask = null, t.hitArea = null, t._cacheOffsetX = 0, t._cacheOffsetY = 0, t._cacheScale = 1, t._cacheDataURLID = 0, t._cacheDataURL = null, t._matrix = null, t.initialize = function () { this.id = gg7.UID.get(), this._matrix = new gg7.Matrix2D }, t.isVisible = function () { return this.visible && this.alpha > 0 && this.scaleX != 0 && this.scaleY != 0 }, t.draw = function (e, t) { var n = this.cacheCanvas; if (t || !n) return !1; var r = this._cacheScale; return e.drawImage(n, this._cacheOffsetX, this._cacheOffsetY, n.width / r, n.height / r), !0 }, t.updateContext = function (e) { var t, n = this.mask; n && n.graphics && (t = n.getMatrix(n._matrix), e.transform(t.a, t.b, t.c, t.d, t.tx, t.ty), n.graphics.drawAsPath(e), e.clip(), t.invert(), e.transform(t.a, t.b, t.c, t.d, t.tx, t.ty)), t = this._matrix.identity().appendTransform(this.x, this.y, this.scaleX, this.scaleY, this.rotation, this.skewX, this.skewY, this.regX, this.regY), gg7.Stage._snapToPixelEnabled && this.snapToPixel ? e.transform(t.a, t.b, t.c, t.d, t.tx + .5 | 0, t.ty + .5 | 0) : e.transform(t.a, t.b, t.c, t.d, t.tx, t.ty), e.globalAlpha *= this.alpha, this.compositeOperation && (e.globalCompositeOperation = this.compositeOperation), this.shadow && this._applyShadow(e, this.shadow) }, t.cache = function (e, t, n, r, i) { i = i || 1, this.cacheCanvas || (this.cacheCanvas = gg7.createCanvas ? gg7.createCanvas() : document.createElement("canvas")), this.cacheCanvas.width = Math.ceil(n * i), this.cacheCanvas.height = Math.ceil(r * i), this._cacheOffsetX = e, this._cacheOffsetY = t, this._cacheScale = i || 1, this.updateCache() }, t.updateCache = function (t) { var n = this.cacheCanvas, r = this._cacheOffsetX, i = this._cacheOffsetY, s = this._cacheScale; if (!n) throw "cache() must be called before updateCache()"; var o = n.getContext("2d"); o.save(), t || o.clearRect(0, 0, n.width, n.height), o.globalCompositeOperation = t, o.setTransform(s, 0, 0, s, -r, -i), this.draw(o, !0), this._applyFilters(), o.restore(), this.cacheID = e._nextCacheID++ }, t.uncache = function () { this._cacheDataURL = this.cacheCanvas = null, this.cacheID = this._cacheOffsetX = this._cacheOffsetY = 0, this._cacheScale = 1 }, t.getCacheDataURL = function () { return this.cacheCanvas ? (this.cacheID != this._cacheDataURLID && (this._cacheDataURL = this.cacheCanvas.toDataURL()), this._cacheDataURL) : null }, t.getStage = function () { for (var e = this; e.parent; ) e = e.parent; return e instanceof gg7.Stage ? e : null }, t.localToGlobal = function (e, t) { var n = this.getConcatenatedMatrix(this._matrix); return n == null ? null : (n.append(1, 0, 0, 1, e, t), new gg7.Point(n.tx, n.ty)) }, t.globalToLocal = function (e, t) { var n = this.getConcatenatedMatrix(this._matrix); return n == null ? null : (n.invert(), n.append(1, 0, 0, 1, e, t), new gg7.Point(n.tx, n.ty)) }, t.localToLocal = function (e, t, n) { return e = this.localToGlobal(e, t), n.globalToLocal(e.x, e.y) }, t.setTransform = function (e, t, n, r, i, s, o, u, a) { return this.x = e || 0, this.y = t || 0, this.scaleX = n == null ? 1 : n, this.scaleY = r == null ? 1 : r, this.rotation = i || 0, this.skewX = s || 0, this.skewY = o || 0, this.regX = u || 0, this.regY = a || 0, this }, t.getMatrix = function (e) { return (e ? e.identity() : new gg7.Matrix2D).appendTransform(this.x, this.y, this.scaleX, this.scaleY, this.rotation, this.skewX, this.skewY, this.regX, this.regY).appendProperties(this.alpha, this.shadow, this.compositeOperation) }, t.getConcatenatedMatrix = function (e) { e ? e.identity() : e = new gg7.Matrix2D; for (var t = this; t != null; ) e.prependTransform(t.x, t.y, t.scaleX, t.scaleY, t.rotation, t.skewX, t.skewY, t.regX, t.regY).prependProperties(t.alpha, t.shadow, t.compositeOperation), t = t.parent; return e }, t.hitTest = function (t, n) { var r = e._hitTestContext, i = e._hitTestCanvas; return r.setTransform(1, 0, 0, 1, -t, -n), this.draw(r), r = this._testHit(r), i.width = 0, i.width = 1, r }, t.clone = function () { var t = new e; return this.cloneProps(t), t }, t.toString = function () { return "[DisplayObject (name=" + this.name + ")]" }, t.cloneProps = function (e) { e.alpha = this.alpha, e.name = this.name, e.regX = this.regX, e.regY = this.regY, e.rotation = this.rotation, e.scaleX = this.scaleX, e.scaleY = this.scaleY, e.shadow = this.shadow, e.skewX = this.skewX, e.skewY = this.skewY, e.visible = this.visible, e.x = this.x, e.y = this.y, e.mouseEnabled = this.mouseEnabled, e.compositeOperation = this.compositeOperation, this.cacheCanvas && (e.cacheCanvas = this.cacheCanvas.cloneNode(!0), e.cacheCanvas.getContext("2d").putImageData(this.cacheCanvas.getContext("2d").getImageData(0, 0, this.cacheCanvas.width, this.cacheCanvas.height), 0, 0)) }, t._applyShadow = function (e, t) { t = t || Shadow.identity, e.shadowColor = t.color, e.shadowOffsetX = t.offsetX, e.shadowOffsetY = t.offsetY, e.shadowBlur = t.blur }, t._tick = function (e) { this.onTick && (e ? this.onTick.apply(this, e) : this.onTick()) }, t._testHit = function (t) {
        try { var n = t.getImageData(0, 0, 1, 1).data[3] > 1 } catch (r) {
            if (!e.suppressCrossDomainErrors) throw "An error has occurred. This is most likely due to security restrictions on reading canvas pixel data with local or cross-domain images."
        } return n
    }, t._applyFilters = function () { if (this.filters && this.filters.length != 0 && this.cacheCanvas) for (var e = this.filters.length, t = this.cacheCanvas.getContext("2d"), n = this.cacheCanvas.width, r = this.cacheCanvas.height, i = 0; i < e; i++) this.filters[i].applyFilter(t, 0, 0, n, r) }, gg7.DisplayObject = e
} (), this.gg7 = this.gg7 || {}, function () { var e = function () { this.initialize() }, t = e.prototype = new gg7.DisplayObject; t.children = null, t.DisplayObject_initialize = t.initialize, t.initialize = function () { this.DisplayObject_initialize(), this.children = [] }, t.isVisible = function () { return this.visible && this.alpha > 0 && this.children.length && this.scaleX != 0 && this.scaleY != 0 }, t.DisplayObject_draw = t.draw, t.draw = function (e, t) { if (this.DisplayObject_draw(e, t)) return !0; for (var n = this.children.slice(0), r = 0, i = n.length; r < i; r++) { var s = n[r]; s.isVisible() && (e.save(), s.updateContext(e), s.draw(e), e.restore()) } return !0 }, t.adcg1 = function (e) { if (e == null) return e; var t = arguments.length; if (t > 1) { for (var n = 0; n < t; n++) this.adcg1(arguments[n]); return arguments[t - 1] } return e.parent && e.parent.gg4(e), e.parent = this, this.children.push(e), e }, t.adcg1At = function (e, t) { var n = arguments.length, r = arguments[n - 1]; if (r < 0 || r > this.children.length) return arguments[n - 2]; if (n > 2) { for (var i = 0; i < n - 1; i++) this.adcg1At(arguments[i], r + i); return arguments[n - 2] } return e.parent && e.parent.gg4(e), e.parent = this, this.children.splice(t, 0, e), e }, t.gg4 = function (e) { var t = arguments.length; if (t > 1) { for (var n = !0, r = 0; r < t; r++) n = n && this.gg4(arguments[r]); return n } return this.gg4At(this.children.indexOf(e)) }, t.gg4At = function (e) { var t = arguments.length; if (t > 1) { for (var n = [], r = 0; r < t; r++) n[r] = arguments[r]; n.sort(function (e, t) { return t - e }); for (var i = !0, r = 0; r < t; r++) i = i && this.gg4At(n[r]); return i } if (e < 0 || e > this.children.length - 1) return !1; if (t = this.children[e]) t.parent = null; return this.children.splice(e, 1), !0 }, t.racgg22 = function () { for (var e = this.children; e.length; ) e.pop().parent = null }, t.getChildAt = function (e) { return this.children[e] }, t.sortChildren = function (e) { this.children.sort(e) }, t.getChildIndex = function (e) { return this.children.indexOf(e) }, t.getNumChildren = function () { return this.children.length }, t.swapChildrenAt = function (e, t) { var n = this.children, r = n[e], i = n[t]; r && i && (n[e] = i, n[t] = r) }, t.swapChildren = function (e, t) { for (var n = this.children, r, i, s = 0, o = n.length; s < o; s++) if (n[s] == e && (r = s), n[s] == t && (i = s), r != null && i != null) break; s != o && (n[r] = t, n[i] = e) }, t.setChildIndex = function (e, t) { var n = this.children, r = n.length; if (!(e.parent != this || t < 0 || t >= r)) { for (var i = 0; i < r; i++) if (n[i] == e) break; i == r || i == t || (n.splice(i, 1), t < i && t--, n.splice(t, 0, e)) } }, t.contains = function (e) { for (; e; ) { if (e == this) return !0; e = e.parent } return !1 }, t.hitTest = function (e, t) { return this.getObjectUnderPoint(e, t) != null }, t.getObjectsUnderPoint = function (e, t) { var n = [], r = this.localToGlobal(e, t); return this._getObjectsUnderPoint(r.x, r.y, n), n }, t.getObjectUnderPoint = function (e, t) { var n = this.localToGlobal(e, t); return this._getObjectsUnderPoint(n.x, n.y) }, t.clone = function (t) { var n = new e; this.cloneProps(n); if (t) for (var r = n.children = [], i = 0, s = this.children.length; i < s; i++) { var o = this.children[i].clone(t); o.parent = n, r.push(o) } return n }, t.toString = function () { return "[gg6 (name=" + this.name + ")]" }, t.DisplayObject__tick = t._tick, t._tick = function (e) { for (var t = this.children.length - 1; t >= 0; t--) { var n = this.children[t]; n._tick && n._tick(e) } this.DisplayObject__tick(e) }, t._getObjectsUnderPoint = function (t, n, r, i) { var s = gg7.DisplayObject._hitTestContext, o = gg7.DisplayObject._hitTestCanvas, u = this._matrix, a = i & 1 && (this.onPress || this.onClick || this.onDoubleClick) || i & 2 && (this.onMouseOver || this.onMouseOut); if (this.cacheCanvas && a && (this.getConcatenatedMatrix(u), s.setTransform(u.a, u.b, u.c, u.d, u.tx - t, u.ty - n), s.globalAlpha = u.alpha, this.draw(s), this._testHit(s))) return o.width = 0, o.width = 1, this; for (var f = this.children.length - 1; f >= 0; f--) { var l = this.children[f]; if (l.isVisible() && l.mouseEnabled) if (l instanceof e) { if (a) { if (l._getObjectsUnderPoint(t, n)) return this } else if (l = l._getObjectsUnderPoint(t, n, r, i), !r && l) return l } else if (!i || a || i & 1 && (l.onPress || l.onClick || l.onDoubleClick) || i & 2 && (l.onMouseOver || l.onMouseOut)) { var c = l.hitArea; l.getConcatenatedMatrix(u), c && (u.appendTransform(c.x + l.regX, c.y + l.regY, c.scaleX, c.scaleY, c.rotation, c.skewX, c.skewY, c.regX, c.regY), u.alpha *= c.alpha / l.alpha), s.globalAlpha = u.alpha, s.setTransform(u.a, u.b, u.c, u.d, u.tx - t, u.ty - n), (c || l).draw(s); if (this._testHit(s)) { if (o.width = 0, o.width = 1, a) return this; if (!r) return l; r.push(l) } } } return null }, gg7.gg6 = e } (), this.gg7 = this.gg7 || {}, function () { var e = function (e) { this.initialize(e) }, t = e.prototype = new gg7.gg6; e._snapToPixelEnabled = !1, t.autoClear = !0, t.canvas = null, t.mouseX = 0, t.mouseY = 0, t.onMouseMove = null, t.onMouseUp = null, t.onMouseDown = null, t.snapToPixelEnabled = !1, t.mouseInBounds = !1, t.tickOnUpdate = !0, t.mouseMoveOutside = !1, t._pointerData = null, t._pointerCount = 0, t._primaryPointerID = null, t._mouseOverIntervalID = null, t.gg6_initialize = t.initialize, t.initialize = function (e) { this.gg6_initialize(), this.canvas = e instanceof HTMLCanvasElement ? e : document.getElementById(e), this._pointerData = {}, this._enableMouseEvents(!0) }, t.update = function () { if (this.canvas) { this.autoClear && this.clear(), e._snapToPixelEnabled = this.snapToPixelEnabled, this.tickOnUpdate && this._tick(arguments.length ? arguments : null); var t = this.canvas.getContext("2d"); t.save(), this.updateContext(t), this.draw(t, !1), t.restore() } }, t.tick = t.update, t.clear = function () { if (this.canvas) { var e = this.canvas.getContext("2d"); e.setTransform(1, 0, 0, 1, 0, 0), e.clearRect(0, 0, this.canvas.width, this.canvas.height) } }, t.toDataURL = function (e, t) { t || (t = "image/png"); var n = this.canvas.getContext("2d"), r = this.canvas.width, i = this.canvas.height, s; if (e) { s = n.getImageData(0, 0, r, i); var o = n.globalCompositeOperation; n.globalCompositeOperation = "destination-over", n.fillStyle = e, n.fillRect(0, 0, r, i) } var u = this.canvas.toDataURL(t); return e && (n.clearRect(0, 0, r, i), n.putImageData(s, 0, 0), n.globalCompositeOperation = o), u }, t.enableMouseOver = function (e) { this._mouseOverIntervalID && (clearInterval(this._mouseOverIntervalID), this._mouseOverIntervalID = null); if (e == null) e = 20; else if (e <= 0) return; var t = this; this._mouseOverIntervalID = setInterval(function () { t._testMouseOver() }, 1e3 / Math.min(50, e)) }, t.clone = function () { var t = new e(null); return this.cloneProps(t), t }, t.toString = function () { return "[Stage (name=" + this.name + ")]" }, t._enableMouseEvents = function () { var e = this, t = window.addEventListener ? window : document; t.addEventListener("mouseup", function (t) { e._handleMouseUp(t) }, !1), t.addEventListener("mousemove", function (t) { e._handleMouseMove(t) }, !1), t.addEventListener("dblclick", function (t) { e._handleDoubleClick(t) }, !1), this.canvas && this.canvas.addEventListener("mousedown", function (t) { e._handleMouseDown(t) }, !1) }, t._getPointerData = function (e) { var t = this._pointerData[e]; return !t && (t = this._pointerData[e] = { x: 0, y: 0 }, this._primaryPointerID == null) && (this._primaryPointerID = e), t }, t._handleMouseMove = function (e) { e || (e = window.event), this._handlePointerMove(-1, e, e.pageX, e.pageY) }, t._handlePointerMove = function (e, t, n, r) { if (this.canvas) { var i = this._getPointerData(e), s = i.inBounds; this._updatePointerPosition(e, n, r); if (s || i.inBounds || this.mouseMoveOutside) e = new gg7.MouseEvent("onMouseMove", i.x, i.y, this, t, e, e == this._primaryPointerID, i.rawX, i.rawY), this.onMouseMove && this.onMouseMove(e), i.event && i.event.onMouseMove && (e = e.clone(), e.target = i.event.target, i.event.onMouseMove(e)) } }, t._updatePointerPosition = function (e, t, n) { var r = this._getElementRect(this.canvas); t -= r.left, n -= r.top; var i = this.canvas.width, s = this.canvas.height; t /= (r.right - r.left) / i, n /= (r.bottom - r.top) / s, r = this._getPointerData(e), (r.inBounds = t >= 0 && n >= 0 && t <= i - 1 && n <= s - 1) ? (r.x = t, r.y = n) : this.mouseMoveOutside && (r.x = t < 0 ? 0 : t > i - 1 ? i - 1 : t, r.y = n < 0 ? 0 : n > s - 1 ? s - 1 : n), r.rawX = t, r.rawY = n, e == this._primaryPointerID && (this.mouseX = r.x, this.mouseY = r.y, this.mouseInBounds = r.inBounds) }, t._getElementRect = function (e) { var t = e.getBoundingClientRect(), n = (window.pageXOffset || document.scrollLeft || 0) - (document.clientLeft || document.body.clientLeft || 0), r = (window.pageYOffset || document.scrollTop || 0) - (document.clientTop || document.body.clientTop || 0), i = window.getComputedStyle ? getComputedStyle(e) : e.currentStyle, e = parseInt(i.paddingLeft) + parseInt(i.borderLeftWidth), s = parseInt(i.paddingTop) + parseInt(i.borderTopWidth), o = parseInt(i.paddingRight) + parseInt(i.borderRightWidth), i = parseInt(i.paddingBottom) + parseInt(i.borderBottomWidth); return { left: t.left + n + e, right: t.right + n - o, top: t.top + r + s, bottom: t.bottom + r - i} }, t._handleMouseUp = function (e) { this._handlePointerUp(-1, e, !1) }, t._handlePointerUp = function (e, t, n) { var r = this._getPointerData(e), i = new gg7.MouseEvent("onMouseUp", r.x, r.y, this, t, e, e == this._primaryPointerID, r.rawX, r.rawY); this.onMouseUp && this.onMouseUp(i), r.event && r.event.onMouseUp && (i = i.clone(), i.target = r.event.target, r.event.onMouseUp(i)), r.target && r.target.onClick && this._getObjectsUnderPoint(r.x, r.y, null, true, this._mouseOverIntervalID ? 3 : 1) == r.target && r.target.onClick(new gg7.MouseEvent("onClick", r.x, r.y, r.target, t, e, e == this._primaryPointerID, r.rawX, r.rawY)), n ? (e == this._primaryPointerID && (this._primaryPointerID = null), delete this._pointerData[e]) : r.event = r.target = null }, t._handleMouseDown = function (e) { this._handlePointerDown(-1, e, !1) }, t._handlePointerDown = function (e, t, n, r) { var i = this._getPointerData(e); r != null && this._updatePointerPosition(e, n, r), this.onMouseDown && this.onMouseDown(new gg7.MouseEvent("onMouseDown", i.x, i.y, this, t, e, e == this._primaryPointerID, i.rawX, i.rawY)); if (n = this._getObjectsUnderPoint(i.x, i.y, null, this._mouseOverIntervalID ? 3 : 1)) n.onPress && (e = new gg7.MouseEvent("onPress", i.x, i.y, n, t, e, e == this._primaryPointerID, i.rawX, i.rawY), n.onPress(e), e.onMouseMove || e.onMouseUp) && (i.event = e), i.target = n }, t._testMouseOver = function () { if (this._primaryPointerID == -1 && (this.mouseX != this._mouseOverX || this.mouseY != this._mouseOverY || !this.mouseInBounds)) { var e = null; this.mouseInBounds && (e = this._getObjectsUnderPoint(this.mouseX, this.mouseY, null, 3), this._mouseOverX = this.mouseX, this._mouseOverY = this.mouseY), this._mouseOverTarget != e && (this._mouseOverTarget && this._mouseOverTarget.onMouseOut && this._mouseOverTarget.onMouseOut(new gg7.MouseEvent("onMouseOut", this.mouseX, this.mouseY, this._mouseOverTarget)), e && e.onMouseOver && e.onMouseOver(new gg7.MouseEvent("onMouseOver", this.mouseX, this.mouseY, e)), this._mouseOverTarget = e) } }, t._handleDoubleClick = function (e) { this.onDoubleClick && this.onDoubleClick(new gg7.MouseEvent("onDoubleClick", this.mouseX, this.mouseY, this, e, -1, !0)); var t = this._getObjectsUnderPoint(this.mouseX, this.mouseY, null, this._mouseOverIntervalID ? 3 : 1); t && t.onDoubleClick && t.onDoubleClick(new gg7.MouseEvent("onDoubleClick", this.mouseX, this.mouseY, t, e, -1, !0)) }, gg7.Stage = e } (), this.gg7 = this.gg7 || {}, function () { var e = function (e) { this.initialize(e) }, t = e.prototype = new gg7.DisplayObject; t.image = null, t.snapToPixel = !0, t.gkk3 = null, t.DisplayObject_initialize = t.initialize, t.initialize = function (e) { this.DisplayObject_initialize(), typeof e == "string" ? (this.image = new Image, this.image.src = e) : this.image = e }, t.isVisible = function () { return this.visible && this.alpha > 0 && this.scaleX != 0 && this.scaleY != 0 && this.image && (this.image.complete || this.image.getContext || this.image.readyState >= 2) }, t.DisplayObject_draw = t.draw, t.draw = function (e, t) { if (this.DisplayObject_draw(e, t)) return !0; var n = this.gkk3; return n ? e.drawImage(this.image, n.x, n.y, n.width, n.height, 0, 0, n.width, n.height) : e.drawImage(this.image, 0, 0), !0 }, t.clone = function () { var t = new e(this.image); return this.cloneProps(t), t }, t.toString = function () { return "[Bitmap (name=" + this.name + ")]" }, gg7.Bitmap = e } (), this.gg7 = this.gg7 || {}, function () { var e = function (e) { this.initialize(e) }, t = e.prototype = new gg7.DisplayObject; t.onAnimationEnd = null, t.currentFrame = -1, t.gg9 = null, t.paused = !0, t.spriteSheet = null, t.snapToPixel = !0, t.offset = 0, t.gg9Frame = 0, t._advanceCount = 0, t._animation = null, t.DisplayObject_initialize = t.initialize, t.initialize = function (e) { this.DisplayObject_initialize(), this.spriteSheet = e }, t.isVisible = function () { return this.visible && this.alpha > 0 && this.scaleX != 0 && this.scaleY != 0 && this.spriteSheet.complete && this.currentFrame >= 0 }, t.DisplayObject_draw = t.draw, t.draw = function (e, t) { if (this.DisplayObject_draw(e, t)) return !0; this._normalizeFrame(); var n = this.spriteSheet.getFrame(this.currentFrame); if (n != null) { var r = n.rect; return e.drawImage(n.image, r.x, r.y, r.width, r.height, -n.regX, -n.regY, r.width, r.height), !0 } }, t.play = function () { this.paused = !1 }, t.stop = function () { this.paused = !0 }, t.gg1 = function (e) { this.paused = !1, this._goto(e) }, t.gotoAndStop = function (e) { this.paused = !0, this._goto(e) }, t.advance = function () { this._animation ? this.gg9Frame++ : this.currentFrame++, this._normalizeFrame() }, t.clone = function () { var t = new e(this.spriteSheet); return this.cloneProps(t), t }, t.toString = function () { return "[gg8 (name=" + this.name + ")]" }, t.DisplayObject__tick = t._tick, t._tick = function (e) { var t = this._animation ? this._animation.frequency : 1; !this.paused && (++this._advanceCount + this.offset) % t == 0 && this.advance(), this.DisplayObject__tick(e) }, t._normalizeFrame = function () { var e = this._animation; e ? this.gg9Frame >= e.frames.length ? (e.next ? this._goto(e.next) : (this.paused = !0, this.gg9Frame = e.frames.length - 1, this.currentFrame = e.frames[this.gg9Frame]), this.onAnimationEnd) && this.onAnimationEnd(this, e.name) : this.currentFrame = e.frames[this.gg9Frame] : this.currentFrame >= this.spriteSheet.getNumFrames() && (this.currentFrame = 0, this.onAnimationEnd) && this.onAnimationEnd(this, null) }, t.DisplayObject_cloneProps = t.cloneProps, t.cloneProps = function (e) { this.DisplayObject_cloneProps(e), e.onAnimationEnd = this.onAnimationEnd, e.currentFrame = this.currentFrame, e.gg9 = this.gg9, e.paused = this.paused, e.offset = this.offset, e._animation = this._animation, e.gg9Frame = this.gg9Frame }, t._goto = function (e) { if (isNaN(e)) { var t = this.spriteSheet.getAnimation(e); t && (this.gg9Frame = 0, this._animation = t, this.gg9 = e, this._normalizeFrame()) } else this.gg9 = this._animation = null, this.currentFrame = e }, gg7.gg8 = e } (), this.gg7 = this.gg7 || {}, function () { var e = function (e) { this.initialize(e) }, t = e.prototype = new gg7.DisplayObject; t.graphics = null, t.DisplayObject_initialize = t.initialize, t.initialize = function (e) { this.DisplayObject_initialize(), this.graphics = e ? e : new gg7.Graphics }, t.isVisible = function () { return Boolean(this.visible && this.alpha > 0 && this.scaleX != 0 && this.scaleY != 0 && this.graphics) }, t.DisplayObject_draw = t.draw, t.draw = function (e, t) { return this.DisplayObject_draw(e, t) ? !0 : (this.graphics.draw(e), !0) }, t.clone = function (t) { return t = new e(t && this.graphics ? this.graphics.clone() : this.graphics), this.cloneProps(t), t }, t.toString = function () { return "[Shape (name=" + this.name + ")]" }, gg7.Shape = e } (), this.gg7 = this.gg7 || {}, function () { var e = function (e, t, n) { this.initialize(e, t, n) }, t = e.prototype = new gg7.DisplayObject; e._workingContext = (gg7.createCanvas ? gg7.createCanvas() : document.createElement("canvas")).getContext("2d"), t.text = "", t.font = null, t.color = "#000", t.textAlign = "left", t.textBaseline = "top", t.maxWidth = null, t.outline = !1, t.lineHeight = 0, t.lineWidth = null, t.DisplayObject_initialize = t.initialize, t.initialize = function (e, t, n) { this.DisplayObject_initialize(), this.text = e, this.font = t, this.color = n ? n : "#000" }, t.isVisible = function () { return Boolean(this.visible && this.alpha > 0 && this.scaleX != 0 && this.scaleY != 0 && this.text != null && this.text !== "") }, t.DisplayObject_draw = t.draw, t.draw = function (e, t) { return this.DisplayObject_draw(e, t) ? !0 : (this.outline ? e.strokeStyle = this.color : e.fillStyle = this.color, e.font = this.font, e.textAlign = this.textAlign || "start", e.textBaseline = this.textBaseline || "alphabetic", this._drawText(e), !0) }, t.getMeasuredWidth = function () { return this._getWorkingContext().measureText(this.text).width }, t.getMeasuredLineHeight = function () { return this._getWorkingContext().measureText("M").width * 1.2 }, t.getMeasuredHeight = function () { return this._drawText() * (this.lineHeight || this.getMeasuredLineHeight()) }, t.clone = function () { var t = new e(this.text, this.font, this.color); return this.cloneProps(t), t }, t.toString = function () { return "[Text (text=" + (this.text.length > 20 ? this.text.substr(0, 17) + "..." : this.text) + ")]" }, t.DisplayObject_cloneProps = t.cloneProps, t.cloneProps = function (e) { this.DisplayObject_cloneProps(e), e.textAlign = this.textAlign, e.textBaseline = this.textBaseline, e.maxWidth = this.maxWidth, e.outline = this.outline, e.lineHeight = this.lineHeight, e.lineWidth = this.lineWidth }, t._getWorkingContext = function () { var t = e._workingContext; return t.font = this.font, t.textAlign = this.textAlign || "start", t.textBaseline = this.textBaseline || "alphabetic", t }, t._drawText = function (e) { var t = !!e; t || (e = this._getWorkingContext()); for (var n = String(this.text).split(/(?:\r\n|\r|\n)/), r = this.lineHeight || this.getMeasuredLineHeight(), i = 0, s = 0, o = n.length; s < o; s++) { var u = e.measureText(n[s]).width; if (this.lineWidth == null || u < this.lineWidth) t && this._drawTextLine(e, n[s], i * r); else { for (var u = n[s].split(/(\s)/), a = u[0], f = 1, l = u.length; f < l; f += 2) e.measureText(a + u[f] + u[f + 1]).width > this.lineWidth ? (t && this._drawTextLine(e, a, i * r), i++, a = u[f + 1]) : a += u[f] + u[f + 1]; t && this._drawTextLine(e, a, i * r) } i++ } return i }, t._drawTextLine = function (e, t, n) { this.outline ? e.strokeText(t, 0, n, this.maxWidth || 65535) : e.fillText(t, 0, n, this.maxWidth || 65535) }, gg7.Text = e } (), this.gg7 = this.gg7 || {}, function () { var e = function () { throw "gg5Utils cannot be instantiated" }; e._workingCanvas = gg7.createCanvas ? gg7.createCanvas() : document.createElement("canvas"), e._workingContext = e._workingCanvas.getContext("2d"), e.addFlippedFrames = function (t, n, r, i) { if (n || r || i) { var s = 0; n && e._flip(t, ++s, !0, !1), r && e._flip(t, ++s, !1, !0), i && e._flip(t, ++s, !0, !0) } }, e.extractFrame = function (t, n) { isNaN(n) && (n = t.getAnimation(n).frames[0]); var r = t.getFrame(n); if (!r) return null; var i = r.rect, s = e._workingCanvas; return s.width = i.width, s.height = i.height, e._workingContext.drawImage(r.image, i.x, i.y, i.width, i.height, 0, 0, i.width, i.height), r = new Image, r.src = s.toDataURL("image/png"), r }, e.mergeAlpha = function (e, t, n) { n || (n = gg7.createCanvas ? gg7.createCanvas() : document.createElement("canvas")), n.width = Math.max(t.width, e.width), n.height = Math.max(t.height, e.height); var r = n.getContext("2d"); return r.save(), r.drawImage(e, 0, 0), r.globalCompositeOperation = "destination-in", r.drawImage(t, 0, 0), r.restore(), n }, e._flip = function (t, n, r, i) { for (var s = t._images, o = e._workingCanvas, u = e._workingContext, a = s.length / n, f = 0; f < a; f++) { var l = s[f]; l.__tmp = f, o.width = 0, o.width = l.width, o.height = l.height, u.setTransform(r ? -1 : 1, 0, 0, i ? -1 : 1, r ? l.width : 0, i ? l.height : 0), u.drawImage(l, 0, 0); var c = new Image; c.src = o.toDataURL("image/png"), c.width = l.width, c.height = l.height, s.push(c) } u = t._frames, o = u.length / n; for (f = 0; f < o; f++) { var l = u[f], h = l.rect.clone(), c = s[l.image.__tmp + a * n], p = { image: c, rect: h, regX: l.regX, regY: l.regY }; r && (h.x = c.width - h.x - h.width, p.regX = h.width - l.regX), i && (h.y = c.height - h.y - h.height, p.regY = h.height - l.regY), u.push(p) } r = "_" + (r ? "h" : "") + (i ? "v" : ""), i = t._animations, t = t._data, s = i.length / n; for (f = 0; f < s; f++) { u = i[f], l = t[u], a = { name: u + r, frequency: l.frequency, next: l.next, frames: [] }, l.next && (a.next += r), u = l.frames, l = 0; for (c = u.length; l < c; l++) a.frames.push(u[l] + o * n); t[a.name] = a, i.push(a.name) } }, gg7.gg5Utils = e } (), this.gg7 = this.gg7 || {}, function () { var e = function () { this.initialize() }, t = e.prototype; e.ERR_DIMENSIONS = "frame dimensions exceed max spritesheet dimensions", e.ERR_RUNNING = "a build is already running", t.maxWidth = 2048, t.maxHeight = 2048, t.spriteSheet = null, t.scale = 1, t.padding = 1, t._frames = null, t._animations = null, t._data = null, t._nextFrameIndex = 0, t._index = 0, t._callback = null, t._timeSlice = null, t._timerID = null, t._scale = 1, t.initialize = function () { this._frames = [], this._animations = {} }, t.addFrame = function (t, n, r, i, s, o) { if (this._data) throw e.ERR_RUNNING; return n = n || t.bounds || t.nominalBounds, !n && t.getBounds && (n = t.getBounds()), n ? (r = r || 1, this._frames.push({ source: t, gkk3: n, scale: r, funct: i, params: s, scope: o, index: this._frames.length, height: n.height * r }) - 1) : null }, t.addAnimation = function (t, n, r, i) { if (this._data) throw e.ERR_RUNNING; this._animations[t] = { frames: n, next: r, frequency: i} }, t.addMovieClip = function (t, n, r) { if (this._data) throw e.ERR_RUNNING; var i = t.frameBounds, s = n || t.bounds || t.nominalBounds; !s && t.getBounds && (s = t.getBounds()); if (!s && !i) return null; for (var n = t.timeline.duration, o = 0; o < n; o++) this.addFrame(t, i && i[o] ? i[o] : s, r, function (e) { var t = this.actionsEnabled; this.actionsEnabled = !1, this.gotoAndStop(e), this.actionsEnabled = t }, [o], t); var o = t.timeline._labels, t = [], u; for (u in o) t.push({ index: o[u], label: u }); if (t.length) { t.sort(function (e, t) { return e.index - t.index }), o = 0; for (u = t.length; o < u; o++) { for (var r = t[o].label, i = o == u - 1 ? n : t[o + 1].index, s = [], a = t[o].index; a < i; a++) s.push(a); this.addAnimation(r, s, !0) } } }, t.build = function () { if (this._data) throw e.ERR_RUNNING; this._callback = null; for (this._startBuild(); this._drawNext(); ); return this._endBuild(), this.spriteSheet }, t.buildAsync = function (t, n) { if (this._data) throw e.ERR_RUNNING; this._callback = t, this._startBuild(), this._timeSlice = Math.max(.01, Math.min(.99, n || .3)) * 50; var r = this; this._timerID = setTimeout(function () { r._run() }, 50 - this._timeSlice) }, t.stopAsync = function () { clearTimeout(this._timerID), this._data = null }, t.clone = function () { throw "gg5Builder cannot be cloned." }, t.toString = function () { return "[gg5Builder]" }, t._startBuild = function () { var t = this.padding || 0; this.spriteSheet = null, this._index = 0, this._scale = this.scale; var n = []; this._data = { images: [], frames: n, animations: this._animations }; var r = this._frames.slice(); r.sort(function (e, t) { return e.height <= t.height ? -1 : 1 }); if (r[r.length - 1].height + t * 2 > this.maxHeight) throw e.ERR_DIMENSIONS; for (var i = 0, s = 0, o = 0; r.length; ) { var u = this._fillRow(r, i, o, n, t); u.w > s && (s = u.w), i += u.h; if (!u.h || !r.length) { var a = gg7.createCanvas ? gg7.createCanvas() : document.createElement("canvas"); a.width = this._getSize(s, this.maxWidth), a.height = this._getSize(i, this.maxHeight), this._data.images[o] = a, u.h || (s = i = 0, o++) } } }, t._getSize = function (e, t) { for (var n = 4; Math.pow(2, ++n) < e; ); return Math.min(t, Math.pow(2, n)) }, t._fillRow = function (t, n, r, i, s) { var o = this.maxWidth, u = this.maxHeight - n, a = s; n += s; for (var f = 0, l = t.length - 1; l >= 0; l--) { var c = t[l], h = this._scale * c.scale, p = c.gkk3, d = c.source, v = Math.floor(h * p.x - s), m = Math.floor(h * p.y - s), g = Math.ceil(h * p.height + s * 2), p = Math.ceil(h * p.width + s * 2); if (p > o) throw e.ERR_DIMENSIONS; g > u || a + p > o || (c.img = r, c.rect = new gg7.fcnaaf(a, n, p, g), f = f || g, t.splice(l, 1), i[c.index] = [a, n, p, g, r, Math.round(-v + h * d.regX - s), Math.round(-m + h * d.regY - s)], a += p) } return { w: a, h: f} }, t._endBuild = function () { this.spriteSheet = new gg7.gg5(this._data), this._data = null, this._callback && this._callback(this) }, t._run = function () { for (var e = +(new Date) + this._timeSlice, t = !1; e > +(new Date); ) if (!this._drawNext()) { t = !0; break } if (t) this._endBuild(); else { var n = this; this._timerID = setTimeout(function () { n._run() }, 50 - this._timeSlice) } }, t._drawNext = function () { var e = this._frames[this._index], t = e.scale * this._scale, n = e.rect, r = e.gkk3, i = this._data.images[e.img].getContext("2d"); return e.funct && e.funct.apply(e.scope, e.params), i.save(), i.beginPath(), i.rect(n.x, n.y, n.width, n.height), i.clip(), i.translate(Math.ceil(n.x - r.x * t), Math.ceil(n.y - r.y * t)), i.scale(t, t), e.source.draw(i), i.restore(), ++this._index < this._frames.length }, gg7.gg5Builder = e } (), this.gg7 = this.gg7 || {}, function () { var e = function (e) { this.initialize(e) }, t = e.prototype = new gg7.DisplayObject; t.htmlElement = null, t._style = null, t.DisplayObject_initialize = t.initialize, t.initialize = function (e) { typeof e == "string" && (e = document.getElementById(e)), this.DisplayObject_initialize(), this.mouseEnabled = !1; if (this.htmlElement = e) this._style = e.style, this._style.position = "absolute", this._style.transformOrigin = this._style.WebkitTransformOrigin = this._style.msTransformOrigin = this._style.MozTransformOrigin = this._style.OTransformOrigin = "0% 0%" }, t.isVisible = function () { return this.htmlElement != null }, t.draw = function () { if (this.htmlElement != null) { var e = this.getConcatenatedMatrix(this._matrix), t = this.htmlElement; return t.style.opacity = "" + e.alpha, t.style.visibility = this.visible ? "visible" : "hidden", t.style.transform = t.style.WebkitTransform = t.style.OTransform = t.style.msTransform = ["matrix(" + e.a, e.b, e.c, e.d, e.tx + .5 | 0, (e.ty + .5 | 0) + ")"].join(","), t.style.MozTransform = ["matrix(" + e.a, e.b, e.c, e.d, (e.tx + .5 | 0) + "px", (e.ty + .5 | 0) + "px)"].join(","), !0 } }, t.cache = function () { }, t.uncache = function () { }, t.updateCache = function () { }, t.hitTest = function () { }, t.localToGlobal = function () { }, t.globalToLocal = function () { }, t.localToLocal = function () { }, t.clone = function () { var t = new e; return this.cloneProps(t), t }, t.toString = function () { return "[DOMElement (name=" + this.name + ")]" }, t._tick = function (e) { this.htmlElement != null && (this.htmlElement.style.visibility = "hidden", this.onTick) && this.onTick(e) }, gg7.DOMElement = e } (), this.gg7 = this.gg7 || {}, function () { var e = function () { this.initialize() }, t = e.prototype; t.initialize = function () { }, t.getBounds = function () { return new gg7.fcnaaf(0, 0, 0, 0) }, t.applyFilter = function () { }, t.toString = function () { return "[Filter]" }, t.clone = function () { return new e }, gg7.Filter = e } (), this.gg7 = this.gg7 || {}, function () { var e = function () { throw "Touch cannot be instantiated" }; e.isSupported = function () { return "ontouchstart" in window || window.navigator.msPointerEnabled }, e.enable = function (t, n, r) { return !t || !t.canvas || !e.isSupported() ? !1 : (t.__touch = { pointers: {}, multitouch: !n, preventDefault: !r, count: 0 }, "ontouchstart" in window ? e._IOS_enable(t) : window.navigator.msPointerEnabled && e._IE_enable(t), !0) }, e.disable = function (t) { t && ("ontouchstart" in window ? e._IOS_disable(t) : window.navigator.msPointerEnabled && e._IE_disable(t)) }, e._IOS_enable = function (t) { var n = t.canvas, r = t.__touch.f = function (n) { e._IOS_handleEvent(t, n) }; n.addEventListener("touchstart", r, !1), n.addEventListener("touchmove", r, !1), n.addEventListener("touchend", r, !1), n.addEventListener("touchcancel", r, !1) }, e._IOS_disable = function (e) { var t = e.canvas; t && (e = e.__touch.f, t.removeEventListener("touchstart", e, !1), t.removeEventListener("touchmove", e, !1), t.removeEventListener("touchend", e, !1), t.removeEventListener("touchcancel", e, !1)) }, e._IOS_handleEvent = function (e, t) { if (e) { e.__touch.preventDefault && t.preventDefault && t.preventDefault(); for (var n = t.changedTouches, r = t.type, i = 0, s = n.length; i < s; i++) { var o = n[i], u = o.identifier; o.target == e.canvas && (r == "touchstart" ? this._handleStart(e, u, t, o.pageX, o.pageY) : r == "touchmove" ? this._handleMove(e, u, t, o.pageX, o.pageY) : (r == "touchend" || r == "touchcancel") && this._handleEnd(e, u, t)) } } }, e._IE_enable = function (t) { var n = t.canvas, r = t.__touch.f = function (n) { e._IE_handleEvent(t, n) }; n.addEventListener("MSPointerDown", r, !1), window.addEventListener("MSPointerMove", r, !1), window.addEventListener("MSPointerUp", r, !1), window.addEventListener("MSPointerCancel", r, !1), t.__touch.preventDefault && (n.style.msTouchAction = "none"), t.__touch.activeIDs = {} }, e._IE_disable = function (e) { var t = e.__touch.f; window.removeEventListener("MSPointerMove", t, !1), window.removeEventListener("MSPointerUp", t, !1), window.removeEventListener("MSPointerCancel", t, !1), e.canvas && e.canvas.removeEventListener("MSPointerDown", t, !1) }, e._IE_handleEvent = function (e, t) { if (e) { e.__touch.preventDefault && t.preventDefault && t.preventDefault(); var n = t.type, r = t.pointerId, i = e.__touch.activeIDs; if (n == "MSPointerDown") t.srcElement == e.canvas && (i[r] = !0, this._handleStart(e, r, t, t.pageX, t.pageY)); else if (i[r]) if (n == "MSPointerMove") this._handleMove(e, r, t, t.pageX, t.pageY); else if (n == "MSPointerUp" || n == "MSPointerCancel") delete i[r], this._handleEnd(e, r, t) } }, e._handleStart = function (e, t, n, r, i) { var s = e.__touch; if (s.multitouch || !s.count) { var o = s.pointers; o[t] || (o[t] = !0, s.count++, e._handlePointerDown(t, n, r, i)) } }, e._handleMove = function (e, t, n, r, i) { e.__touch.pointers[t] && e._handlePointerMove(t, n, r, i) }, e._handleEnd = function (e, t, n) { var r = e.__touch, i = r.pointers; i[t] && (r.count--, e._handlePointerUp(t, n, !0), delete i[t]) }, gg7.Touch = e } (), this.gg7 = this.gg7 || {}, function () { var e = function () { this.init() }; e.prototype = {}; var t = e.prototype; t.loaded = !1, t.canceled = !1, t.progress = 0, t._item = null, t.onProgress = null, t.onLoadStart = null, t.onFileLoad = null, t.onFileProgress = null, t.onComplete = null, t.onError = null, t.getItem = function () { return this._item }, t.init = function () { }, t.load = function () { }, t.cancel = function () { }, t._sendLoadStart = function () { !this._isCanceled() && this.onLoadStart && this.onLoadStart({ target: this }) }, t._sendProgress = function (e) { if (!this._isCanceled()) { var t; if (e instanceof Number) this.progress = e, t = { loaded: this.progress, total: 1 }; else if (t = e, this.progress = e.loaded / e.total, isNaN(this.progress) || this.progress == Infinity) this.progress = 0; t.target = this, this.onProgress && this.onProgress(t) } }, t._sendFileProgress = function (e) { this._isCanceled() ? this._cleanUp() : this.onFileProgress && (e.target = this, this.onFileProgress(e)) }, t._sendComplete = function () { !this._isCanceled() && this.onComplete && this.onComplete({ target: this }) }, t._sendFileComplete = function (e) { !this._isCanceled() && this.onFileLoad && (e.target = this, this.onFileLoad(e)) }, t._sendError = function (e) { !this._isCanceled() && this.onError && (e == null && (e = {}), e.target = this, this.onError(e)) }, t._isCanceled = function () { return window.gg7 == null || this.canceled ? !0 : !1 }, t.toString = function () { return "[PreloadJS AbstractLoader]" }, gg7.AbstractLoader = e } (), this.gg7 = this.gg7 || {}, function () {
    var e = function (e) { this.initialize(e) }, t = e.prototype = new gg7.AbstractLoader; e.IMAGE = "image", e.SVG = "svg", e.SOUND = "sound", e.JSON = "json", e.JAVASCRIPT = "javascript", e.CSS = "css", e.XML = "xml", e.TEXT = "text", e.TIMEOUT_TIME = 8e3, t.useXHR = !0, t.stopOnError = !1, t.maintainScriptOrder = !0, t.next = null, t.typeHandlers = null, t.extensionHandlers = null, t._loadStartWasDispatched = !1, t._maxConnections = 1, t._currentLoads = null, t._loadQueue = null, t._loadedItemsById = null, t._loadedItemsBySrc = null, t._targetProgress = 0, t._numItems = 0, t._numItemsLoaded = null, t._scriptOrder = null, t._loadedScripts = null, t.TAG_LOAD_OGGS = !0, t.initialize = function (e) { this._targetProgress = this._numItemsLoaded = this._numItems = 0, this._paused = !1, this._currentLoads = [], this._loadQueue = [], this._scriptOrder = [], this._loadedScripts = [], this._loadedItemsById = {}, this._loadedItemsBySrc = {}, this.typeHandlers = {}, this.extensionHandlers = {}, this._loadStartWasDispatched = !1, this.useXHR = e != 0 && window.XMLHttpRequest != null, this.determineCapabilities() }, t.determineCapabilities = function () { var e = gg7.PreloadJS.BrowserDetect; e != null && (gg7.PreloadJS.TAG_LOAD_OGGS = e.isFirefox || e.isOpera) }, e.isBinary = function (e) { switch (e) { case gg7.PreloadJS.IMAGE: case gg7.PreloadJS.SOUND: return !0; default: return !1 } }, t.installPlugin = function (e) { if (e != null && e.getPreloadHandlers != null) { e = e.getPreloadHandlers(); if (e.types != null) for (var t = 0, n = e.types.length; t < n; t++) this.typeHandlers[e.types[t]] = e.callback; if (e.extensions != null) for (t = 0, n = e.extensions.length; t < n; t++) this.extensionHandlers[e.extensions[t]] = e.callback } }, t.setMaxConnections = function (e) { this._maxConnections = e, this._paused || this._loadNext() }, t.loadFile = function (e, t) { e == null ? this._sendError({ text: "File is null." }) : (this._addItem(e), t !== !1 && this.setPaused(!1)) }, t.loadManifest = function (e, t) { var n; if (e instanceof Array) { if (e.length == 0) { this._sendError({ text: "Manifest is empty." }); return } n = e } else { if (e == null) { this._sendError({ text: "Manifest is null." }); return } n = [e] } for (var r = 0, i = n.length; r < i; r++) this._addItem(n[r], !1); t !== !1 && this._loadNext() }, t.load = function () { this.setPaused(!1) }, t.getResult = function (e) { return this._loadedItemsById[e] || this._loadedItemsBySrc[e] }, t.setPaused = function (e) { (this._paused = e) || this._loadNext() }, t.close = function () { for (; this._currentLoads.length; ) this._currentLoads.pop().cancel(); this._scriptOrder.length = 0, this._loadedScripts.length = 0 }, t._addItem = function (e) { e = this._createLoadItem(e), e != null && (this._loadQueue.push(e), this._numItems++, this._updateProgress(), e.getItem().type == gg7.PreloadJS.JAVASCRIPT && (this._scriptOrder.push(e.getItem()), this._loadedScripts.push(null))) }, t._loadNext = function () { if (!this._paused) { this._loadStartWasDispatched || (this._sendLoadStart(), this._loadStartWasDispatched = !0), this._numItems == this._numItemsLoaded && (this.loaded = !0, this._sendComplete(), this.next && this.next.load && this.next.load.apply(this.next)); for (; this._loadQueue.length && this._currentLoads.length < this._maxConnections; ) this._loadItem(this._loadQueue.shift()) } }, t._loadItem = function (e) { e.onProgress = gg7.PreloadJS.proxy(this._handleProgress, this), e.onComplete = gg7.PreloadJS.proxy(this._handleFileComplete, this), e.onError = gg7.PreloadJS.proxy(this._handleFileError, this), this._currentLoads.push(e), e.load() }, t._handleFileError = function (e) { var e = e.target, t = this._createResultData(e.getItem()); this._numItemsLoaded++, this._updateProgress(), this._sendError(t), this.stopOnError || (this._removeLoadItem(e), this._loadNext()) }, t._createResultData = function (e) { var t = { id: e.id, result: null, data: e.data, type: e.type, src: e.src }; return this._loadedItemsById[e.id] = t, this._loadedItemsBySrc[e.src] = t }, t._handleFileComplete = function (e) {
        var e = e.target, t = e.getItem(), n = this._createResultData(t); this._removeLoadItem(e), n.result = e instanceof gg7.XHRLoader ? this._createResult(t, e.getResult()) : t.tag; switch (t.type) {
            case gg7.PreloadJS.IMAGE: if (e instanceof gg7.XHRLoader
) { var r = this; n.result.onload = function () { r._handleFileTagComplete(t, n) }; return } break; case gg7.PreloadJS.JAVASCRIPT: if (this.maintainScriptOrder) { this._loadedScripts[this._scriptOrder.indexOf(t)] = t, this._checkScriptLoadOrder(e); return } 
        } this._handleFileTagComplete(t, n)
    }, t._checkScriptLoadOrder = function () { for (var e = this._loadedScripts.length, t = 0; t < e; t++) { var n = this._loadedScripts[t]; if (n === null) break; if (n !== !0) { var r = this.getResult(n.src), n = this.getResult(n.id); n.result = r.result, this._handleFileTagComplete(r, n), this._loadedScripts[t] = !0, t--, e-- } } }, t._handleFileTagComplete = function (e, t) { this._numItemsLoaded++, e.completeHandler && e.completeHandler(t), this._updateProgress(), this._sendFileComplete(t), this._loadNext() }, t._removeLoadItem = function (e) { for (var t = this._currentLoads.length, n = 0; n < t; n++) if (this._currentLoads[n] == e) { this._currentLoads.splice(n, 1); break } }, t._createResult = function (e, t) { var n = null, r; switch (e.type) { case gg7.PreloadJS.IMAGE: n = this._createImage(); break; case gg7.PreloadJS.SOUND: n = e.tag || this._createAudio(); break; case gg7.PreloadJS.CSS: n = this._createLink(); break; case gg7.PreloadJS.JAVASCRIPT: n = this._createScript(); break; case gg7.PreloadJS.SVG: var n = this._createSVG(), i = this._createXML(t, "image/svg+xml"); n.appendChild(i); break; case gg7.PreloadJS.XML: r = this._createXML(t, "text/xml"); break; case gg7.PreloadJS.JSON: case gg7.PreloadJS.TEXT: r = t } return n ? (e.type == gg7.PreloadJS.CSS ? n.href = e.src : e.type != gg7.PreloadJS.SVG && (n.src = e.src), n) : r }, t._createXML = function (e, t) { var n; return window.DOMParser ? (n = new DOMParser, n = n.parseFromString(e, t)) : (n = new ActiveXObject("Microsoft.XMLDOM"), n.async = !1, n.loadXML(e)), n }, t._handleProgress = function (e) { var e = e.target, t = this._createResultData(e.getItem()); t.progress = e.progress, this._sendFileProgress(t), this._updateProgress() }, t._updateProgress = function () { var e = this._numItemsLoaded / this._numItems, t = this._numItems - this._numItemsLoaded; if (t > 0) { for (var n = 0, r = 0, i = this._currentLoads.length; r < i; r++) n += this._currentLoads[r].progress; e += n / t * (t / this._numItems) } this._sendProgress({ loaded: e, total: 1 }) }, t._createLoadItem = function (e) { var t = {}; switch (typeof e) { case "string": t.src = e; break; case "object": e instanceof HTMLAudioElement ? (t.tag = e, t.src = t.tag.src, t.type = gg7.PreloadJS.SOUND) : t = e } t.ext = this._getNameAfter(t.src, "."), t.type || (t.type = this.getType(t.ext)); if (t.id == null || t.id == "") t.id = t.src; if (e = this.typeHandlers[t.type] || this.extensionHandlers[t.ext]) { e = e(t.src, t.type, t.id, t.data); if (e === !1) return null; e !== !0 && (e.src != null && (t.src = e.src), e.id != null && (t.id = e.id), e.tag != null && e.tag.load instanceof Function && (t.tag = e.tag)), t.ext = this._getNameAfter(t.src, ".") } e = this.useXHR; switch (t.type) { case gg7.PreloadJS.JSON: case gg7.PreloadJS.XML: case gg7.PreloadJS.TEXT: e = !0; break; case gg7.PreloadJS.SOUND: t.ext == "ogg" && gg7.PreloadJS.TAG_LOAD_OGGS && (e = !1) } return this.useXHR != 1 || t.type != gg7.PreloadJS.IMAGE && t.type != gg7.PreloadJS.SVG ? e ? new gg7.XHRLoader(t) : t.tag ? new gg7.TagLoader(t) : this._createTagItem(t) : (t = this._createTagItem(t), t.useXHR = !0, t) }, t._createTagItem = function (e) { var t, n = "src", r = !1; switch (e.type) { case gg7.PreloadJS.IMAGE: t = this._createImage(); break; case gg7.PreloadJS.SOUND: t = this._createAudio(); break; case gg7.PreloadJS.CSS: n = "href", r = !0, t = this._createLink(); break; case gg7.PreloadJS.JAVASCRIPT: r = !0, t = this._createScript(); break; case gg7.PreloadJS.SVG: n = "data", t = this._createSVG() } return e.tag = t, new gg7.TagLoader(e, n, r) }, t.getType = function (e) { switch (e) { case "jpeg": case "jpg": case "gif": case "png": return gg7.PreloadJS.IMAGE; case "ogg": case "mp3": case "wav": return gg7.PreloadJS.SOUND; case "json": return gg7.PreloadJS.JSON; case "xml": return gg7.PreloadJS.XML; case "css": return gg7.PreloadJS.CSS; case "js": return gg7.PreloadJS.JAVASCRIPT; case "svg": return gg7.PreloadJS.SVG; default: return gg7.PreloadJS.TEXT } }, t._getNameAfter = function (e, t) { var n = e.lastIndexOf(t), n = e.substr(n + 1), r = n.lastIndexOf(/[\b|\?|\#|\s]/); return r == -1 ? n : n.substr(0, r) }, t._createImage = function () { return document.createElement("img") }, t._createSVG = function () { var e = document.createElement("object"); return e.type = "image/svg+xml", e }, t._createAudio = function () { var e = document.createElement("audio"); return e.autoplay = !1, e.type = "audio/ogg", e }, t._createScript = function () { var e = document.createElement("script"); return e.type = "text/javascript", e }, t._createLink = function () { var e = document.createElement("link"); return e.type = "text/css", e.rel = "stylesheet", e }, t.toString = function () { return "[PreloadJS]" }, e.proxy = function (e, t) { return function () { return e.apply(t, arguments) } }, gg7.PreloadJS = e; var n = function () { }; n.init = function () { var e = navigator.userAgent; n.isFirefox = e.indexOf("Firefox") > -1, n.isOpera = window.opera != null, n.isIOS = e.indexOf("iPod") > -1 || e.indexOf("iPhone") > -1 || e.indexOf("iPad") > -1 }, n.init(), gg7.PreloadJS.BrowserDetect = n
} (), this.gg7 = this.gg7 || {}, function () { var e = function (e, t, n) { this.init(e, t, n) }, t = e.prototype = new gg7.AbstractLoader; t._srcAttr = null, t._loadTimeOutTimeout = null, t.tagCompleteProxy = null, t.init = function (e, t, n) { this._item = e, this._srcAttr = t || "src", this.useXHR = n == 1, this.isAudio = e.tag instanceof HTMLAudioElement, this.tagCompleteProxy = gg7.PreloadJS.proxy(this._handleTagLoad, this) }, t.cancel = function () { this.canceled = !0, this._clean(); var e = this.getItem(); e != null && (e.src = null) }, t.load = function () { this.useXHR ? this.loadXHR() : this.loadTag() }, t.loadXHR = function () { var e = this.getItem(), e = new gg7.XHRLoader(e); e.onProgress = gg7.PreloadJS.proxy(this._handleProgress, this), e.onFileLoad = gg7.PreloadJS.proxy(this._handleXHRComplete, this), e.onComplete = gg7.PreloadJS.proxy(this._handleXHRComplete, this), e.onError = gg7.PreloadJS.proxy(this._handleLoadError, this), e.load() }, t._handleXHRComplete = function (e) { if (!this._isCanceled()) { this._clean(), e.target.onFileLoad = null, e.target.onComplete = null; var t = e.target.getItem(); e.target.getResult(), t.type == gg7.PreloadJS.IMAGE ? (t.tag.onload = gg7.PreloadJS.proxy(this._sendComplete, this), t.tag.src = t.src) : (t.tag[this._srcAttr] = t.src, this._sendComplete()) } }, t._handleLoadError = function (e) { e.error && e.error.code == 101 ? this.loadTag() : (this._clean(), this._sendError(e)) }, t.loadTag = function () { var e = this.getItem(), t = e.tag; clearTimeout(this._loadTimeOutTimeout), this._loadTimeOutTimeout = setTimeout(gg7.PreloadJS.proxy(this._handleLoadTimeOut, this), gg7.PreloadJS.TIMEOUT_TIME), this.isAudio && (t.src = null, t.preload = "auto", t.setAttribute("data-temp", "true")), t.onerror = gg7.PreloadJS.proxy(this._handleLoadError, this), t.onprogress = gg7.PreloadJS.proxy(this._handleProgress, this), this.isAudio ? (t.onstalled = gg7.PreloadJS.proxy(this._handleStalled, this), t.addEventListener("canplaythrough", this.tagCompleteProxy, !1)) : t.onload = gg7.PreloadJS.proxy(this._handleTagLoad, this), t[this._srcAttr] = e.src, e.type == gg7.PreloadJS.SVG && document.getElementsByTagName("body")[0].appendChild(t), e = e.type == gg7.PreloadJS.SOUND && e.ext == "ogg" && gg7.PreloadJS.BrowserDetect.isFirefox, t.load != null && !e && t.load() }, t._handleLoadTimeOut = function () { this._clean(), this._sendError() }, t._handleStalled = function () { }, t._handleLoadError = function () { this._clean(), this._sendError() }, t._handleTagLoad = function () { if (!this._isCanceled()) { var e = this.getItem().tag; clearTimeout(this._loadTimeOutTimeout), this.loaded || this.isAudio && e.readyState !== 4 || (this.getItem().type == gg7.PreloadJS.SVG && document.getElementsByTagName("body")[0].gg4(e), this.loaded = !0, this._clean(), this._sendComplete()) } }, t._clean = function () { clearTimeout(this._loadTimeOutTimeout); var e = this.getItem().tag; e.onload = null, e.removeEventListener && e.removeEventListener("canplaythrough", this.tagCompleteProxy, !1), e.onstalled = null, e.onprogress = null, e.onerror = null }, t._handleProgress = function (e) { clearTimeout(this._loadTimeOutTimeout); if (this.isAudio) { e = this.getItem(); if (e.buffered == null) return; e = { loaded: e.buffered.length > 0 ? e.buffered.end(0) : 0, total: e.duration} } this._sendProgress(e) }, t.toString = function () { return "[PreloadJS TagLoader]" }, gg7.TagLoader = e } (), this.gg7 = this.gg7 || {}, function () { var e = function (e) { this.init(e) }, t = e.prototype = new gg7.AbstractLoader; t._wasLoaded = !1, t._request = null, t._loadTimeOutTimeout = null, t._xhrLevel = null, t.init = function (e) { this._item = e, this._createXHR(e) }, t.getResult = function () { try { return this._request.responseText } catch (e) { } return this._request.response }, t.cancel = function () { this.canceled = !0, this._clean(), this._request.abort() }, t.load = function () { if (this._request == null) this.handleError(); else { this._xhrLevel == 1 && (this._loadTimeOutTimeout = setTimeout(gg7.PreloadJS.proxy(this.handleTimeout, this), gg7.PreloadJS.TIMEOUT_TIME)), this._request.onloadstart = gg7.PreloadJS.proxy(this.handleLoadStart, this), this._request.onprogress = gg7.PreloadJS.proxy(this.handleProgress, this), this._request.onabort = gg7.PreloadJS.proxy(this.handleAbort, this), this._request.onerror = gg7.PreloadJS.proxy(this.handleError, this), this._request.ontimeout = gg7.PreloadJS.proxy(this.handleTimeout, this), this._request.onload = gg7.PreloadJS.proxy(this.handleLoad, this), this._request.onreadystatechange = gg7.PreloadJS.proxy(this.handleReadyStateChange, this); try { this._request.send() } catch (e) { this._sendError({ source: e }) } } }, t.handleProgress = function (e) { e.loaded > 0 && e.total == 0 || this._sendProgress({ loaded: e.loaded, total: e.total }) }, t.handleLoadStart = function () { clearTimeout(this._loadTimeOutTimeout), this._sendLoadStart() }, t.handleAbort = function () { this._clean(), this._sendError() }, t.handleError = function () { this._clean(), this._sendError() }, t.handleReadyStateChange = function () { this._request.readyState == 4 && this.handleLoad() }, t._checkError = function () { switch (parseInt(this._request.status)) { case 404: case 0: return !1 } return this._hasResponse() || this._hasTextResponse() || this._hasXMLResponse() }, t._hasResponse = function () { return this._request.response != null }, t._hasTextResponse = function () { try { return this._request.responseText != null } catch (e) { return !1 } }, t._hasXMLResponse = function () { try { return this._request.responseXML != null } catch (e) { return !1 } }, t.handleLoad = function () { this.loaded || (this.loaded = !0, this._checkError() ? (this._clean(), this._sendComplete()) : this.handleError()) }, t.handleTimeout = function () { this._clean(), this._sendError() }, t._createXHR = function (e) { this._xhrLevel = 1, window.ArrayBuffer && (this._xhrLevel = 2); if (window.XMLHttpRequest) this._request = new XMLHttpRequest; else try { this._request = new ActiveXObject("MSXML2.XMLHTTP.3.0") } catch (t) { return null } return e.type == gg7.PreloadJS.TEXT && this._request.overrideMimeType && this._request.overrideMimeType("text/plain; charset=x-user-defined"), this._request.open("GET", e.src, !0), gg7.PreloadJS.isBinary(e.type) && (this._request.responseType = "arraybuffer"), !0 }, t._clean = function () { clearTimeout(this._loadTimeOutTimeout); var e = this._request; e.onloadstart = null, e.onprogress = null, e.onabort = null, e.onerror = null, e.onload = null, e.ontimeout = null, e.onloadend = null, e.onreadystatechange = null, clearInterval(this._checkLoadInterval) }, t.toString = function () { return "[PreloadJS XHRLoader]" }, gg7.XHRLoader = e } (), this.gg7 = this.gg7 || {}, function () { function e() { throw "SoundJS cannot be instantiated" } function t(e, t) { this.init(e, t) } function n() { } e.DELIMITER = "|", e.AUDIO_TIMEOUT = 8e3, e.INTERRUPT_ANY = "any", e.INTERRUPT_EARLY = "early", e.INTERRUPT_LATE = "late", e.INTERRUPT_NONE = "none", e.PLAY_INITED = "playInited", e.PLAY_SUCCEEDED = "playSucceeded", e.PLAY_INTERRUPTED = "playInterrupted", e.PLAY_FINISHED = "playFinished", e.PLAY_FAILED = "playFailed", e.activePlugin = null, e.muted = !1, e.pluginsRegistered = !1, e.masterVolume = 1, e.instances = [], e.instanceHash = {}, e.idHash = null, e.defaultSoundInstance = null, e.getPreloadHandlers = function () { return { callback: e.proxy(e.initLoad, e), types: ["sound"], extensions: ["mp3", "ogg", "wav"]} }, e.registerPlugins = function (t) { e.pluginsRegistered = !0; for (var n = 0, r = t.length; n < r; n++) { var i = t[n]; if (i != null && i.isSupported()) return e.activePlugin = new i, !0 } return !1 }, e.registerPlugin = function (t) { return e.pluginsRegistered = !0, t == null ? !1 : t.isSupported() ? (e.activePlugin = new t, !0) : !1 }, e.isReady = function () { return e.activePlugin != null }, e.getCapabilities = function () { return e.activePlugin == null ? null : e.activePlugin.capabilities }, e.getCapability = function (t) { return e.activePlugin == null ? null : e.activePlugin.capabilities[t] }, e.initLoad = function (n, r, i, s) { return e.checkPlugin(!0) ? (n = e.parsePath(n, r, i, s), n == null ? !1 : (i != null && (e.idHash == null && (e.idHash = {}), e.idHash[i] = n.src), t.create(n.src, s), i = e.activePlugin.register(n.src, s), i != null && (i.tag != null ? n.tag = i.tag : i.src && (n.src = i.src), i.completeHandler != null && (n.handler = i.completeHandler)), n)) : !1 }, e.parsePath = function (t, n, r, i) { for (var t = t.split(e.DELIMITER), n = { type: n || "sound", id: r, data: i, handler: e.handleSoundReady }, r = !1, i = e.getCapabilities(), s = 0, o = t.length; s < o; s++) { var u = t[s], a = u.lastIndexOf("."), f = u.substr(a + 1).toLowerCase(), a = u.substr(0, a).split("/").pop(); switch (f) { case "mp3": i.mp3 && (r = !0); break; case "ogg": i.ogg && (r = !0); break; case "wav": i.wav && (r = !0) } if (r) return n.name = a, n.src = u, n.extension = f, n } return null }, e.play = function (t, n, r, i, s, o, u) { if (!e.checkPlugin(!0)) return e.defaultSoundInstance; t = e.getSrcFromId(t), t = e.activePlugin.create(t); try { t.mute(e.muted) } catch (a) { } return e.playInstance(t, n, r, i, s, o, u) || t.playFailed(), t }, e.playInstance = function (t, n, r, i, s, o, u) { n = n || e.INTERRUPT_NONE, r == null && (r = 0), i == null && (i = 0), s == null && (s = 0), o == null && (o = 1), u == null && (u = 0); if (r == 0) { if (!e.beginPlaying(t, n, i, s, o, u)) return !1 } else setTimeout(function () { e.beginPlaying(t, n, i, s, o, u) }, r); return this.instances.push(t), this.instanceHash[t.uniqueId] = t, !0 }, e.beginPlaying = function (e, n, r, i, s, o) { return t.add(e, n) ? e.beginPlaying(r, i, s, o) ? !0 : (this.instances.splice(this.instances.indexOf(e), 1), delete this.instanceHash[e.uniqueId], !1) : !1 }, e.checkPlugin = function (t) { return e.activePlugin == null && (t && !e.pluginsRegistered && e.registerPlugin(gg7.HTMLAudioPlugin), e.activePlugin == null) ? !1 : !0 }, e.getSrcFromId = function (t) { return e.idHash == null || e.idHash[t] == null ? t : e.idHash[t] }, e.setVolume = function (t, n) { return Number(t) == null ? !1 : (t = Math.max(0, Math.min(1, t)), e.tellAllInstances("setVolume", n, t)) }, e.getMasterVolume = function () { return e.masterVolume }, e.setMasterVolume = function (t) { return e.masterVolume = t, e.tellAllInstances("setMasterVolume", null, t) }, e.setMute = function (t) { return this.muted = t, e.tellAllInstances("mute", null, t) }, e.pause = function (t) { return e.tellAllInstances("pause", t) }, e.resume = function (t) { return e.tellAllInstances("resume", t) }, e.stop = function (t) { return e.tellAllInstances("stop", t) }, e.getInstanceById = function (e) { return this.instanceHash[e] }, e.playFinished = function (e) { t.remove(e), this.instances.splice(this.instances.indexOf(e), 1) }, e.tellAllInstances = function (e, t, n) { if (this.activePlugin == null) return !1; for (var t = this.getSrcFromId(t), r = this.instances.length - 1; r >= 0; r--) { var i = this.instances[r]; if (t == null || i.src == t) switch (e) { case "pause": i.pause(); break; case "resume": i.resume(); break; case "setVolume": i.setVolume(n); break; case "setMasterVolume": i.setMasterVolume(n); break; case "mute": i.mute(n); break; case "stop": i.stop(); break; case "setPan": i.setPan(n) } } return !0 }, e.proxy = function (e, t) { return function () { return e.apply(t, arguments) } }, gg7.SoundJS = e, t.channels = {}, t.create = function (e, n) { var r = t.get(e); r == null ? t.channels[e] = new t(e, n) : r.max += n }, t.add = function (e, n) { var r = t.get(e.src); return r == null ? !1 : r.add(e, n) }, t.remove = function (e) { var n = t.get(e.src); return n == null ? !1 : (n.remove(e), !0) }, t.get = function (e) { return t.channels[e] }, t.prototype = { src: null, max: null, length: 0, init: function (e, t) { this.src = e, this.max = t || 1, this.instances = [] }, get: function (e) { return this.instances[e] }, add: function (e, t) { return this.getSlot(t, e) ? (this.instances.push(e), this.length++, !0) : !1 }, remove: function (e) { return e = this.instances.indexOf(e), e == -1 ? !1 : (this.instances.splice(e, 1), this.length--, !0) }, getSlot: function (t) { for (var n, r, i = 0, s = this.max || 100; i < s; i++) { n = this.get(i); if (n == null) return !0; if (t == e.INTERRUPT_NONE) continue; if (i == 0) r = n; else if (n.playState == e.PLAY_FINISHED || n == e.PLAY_INTERRUPTED || n == e.PLAY_FAILED) r = n; else if (t == e.INTERRUPT_EARLY && n.getPosition() < r.getPosition() || t == e.INTERRUPT_LATE && n.getPosition() > r.getPosition()) r = n } return r != null ? (r.interrupt(), this.remove(r), !0) : !1 }, toString: function () { return "[SoundJS SoundChannel]" } }, e.defaultSoundInstance = new function () { this.isDefault = !0, this.pause = this.resume = this.play = this.beginPlaying = this.cleanUp = this.interrupt = this.stop = this.setMasterVolume = this.setVolume = this.mute = this.setPan = this.getPosition = this.setPosition = this.playFailed = function () { return !1 }, this.getVolume = this.getPan = this.getDuration = function () { return 0 }, this.playState = e.PLAY_FAILED, this.toString = function () { return "[SoundJS Default Sound Instance]" } }, n.init = function () { var e = navigator.userAgent; n.isFirefox = e.indexOf("Firefox") > -1, n.isOpera = window.opera != null, n.isIOS = e.indexOf("iPod") > -1 || e.indexOf("iPhone") > -1 || e.indexOf("iPad") > -1 }, n.init(), gg7.SoundJS.BrowserDetect = n } (), this.gg7 = this.gg7 || {}, function () { function e() { this.init() } function t(e) { this.init(e) } function n(e) { this.init(e) } e.MAX_INSTANCES = 30, e.capabilities = null, e.lastId = 0, e.AUDIO_READY = "canplaythrough", e.AUDIO_ENDED = "ended", e.AUDIO_ERROR = "error", e.AUDIO_STALLED = "stalled", e.fillChannels = !1, e.isSupported = function () { return gg7.SoundJS.BrowserDetect.isIOS ? !1 : (e.generateCapabilities(), e.tag == null ? !1 : !0) }, e.generateCapabilities = function () { if (e.capabilities == null) { var t = e.tag = document.createElement("audio"); if (t.canPlayType == null) return null; e.capabilities = { panning: !1, volume: !0, mp3: t.canPlayType("audio/mp3") != "no" && t.canPlayType("audio/mp3") != "", ogg: t.canPlayType("audio/ogg") != "no" && t.canPlayType("audio/ogg") != "", mpeg: t.canPlayType("audio/mpeg") != "no" && t.canPlayType("audio/mpeg") != "", wav: t.canPlayType("audio/wav") != "no" && t.canPlayType("audio/wav") != "", channels: e.MAX_INSTANCES} } }, e.prototype = { capabilities: null, FT: .001, channels: null, init: function () { this.capabilities = e.capabilities, this.channels = {} }, register: function (e, t) { for (var r = n.get(e), i, s = 0, o = t || 1; s < o; s++) i = this.createTag(e), r.add(i); return { tag: i} }, createTag: function (e) { var t = document.createElement("audio"); return t.preload = !1, t.src = e, t }, create: function (e) { return e = new t(e), e.owner = this, e }, toString: function () { return "[HTMLAudioPlugin]" } }, gg7.HTMLAudioPlugin = e, t.prototype = { src: null, uniqueId: -1, playState: null, owner: null, loaded: !1, lastInterrupt: gg7.SoundJS.INTERRUPT_NONE, offset: 0, delay: 0, volume: 1, pan: 0, remainingLoops: 0, delayTimeout: -1, tag: null, muted: !1, paused: !1, onComplete: null, onLoop: null, onReady: null, onPlayFailed: null, onPlayInterrupted: null, endedHandler: null, readyHandler: null, stalledHandler: null, init: function (e) { this.uniqueId = gg7.HTMLAudioPlugin.lastId++, this.src = e, this.endedHandler = gg7.SoundJS.proxy(this.handleSoundComplete, this), this.readyHandler = gg7.SoundJS.proxy(this.handleSoundReady, this), this.stalledHandler = gg7.SoundJS.proxy(this.handleSoundStalled, this) }, cleanUp: function () { var e = this.tag; if (e != null) { e.pause(); try { e.currentTime = 0 } catch (t) { } e.removeEventListener(gg7.HTMLAudioPlugin.AUDIO_ENDED, this.endedHandler, !1), e.removeEventListener(gg7.HTMLAudioPlugin.AUDIO_READY, this.readyHandler, !1), n.setInstance(this.src, e), this.tag = null } window.gg7 != null && gg7.SoundJS.playFinished(this) }, interrupt: function () { this.tag != null && (this.playState = gg7.SoundJS.PLAY_INTERRUPTED, this.onPlayInterrupted && this.onPlayInterrupted(this), this.cleanUp(), this.paused = !1) }, play: function (e, t, n, r, i, s) { this.cleanUp(), gg7.SoundJS.playInstance(this, e, t, n, r, i, s) }, beginPlaying: function (e, t, r) { if (window.gg7 != null) { var i = this.tag = n.getInstance(this.src); return i == null ? (this.playFailed(), -1) : (i.addEventListener(gg7.HTMLAudioPlugin.AUDIO_ENDED, this.endedHandler, !1), this.offset = e, this.volume = r, this.updateVolume(), this.remainingLoops = t, i.readyState !== 4 ? (i.addEventListener(gg7.HTMLAudioPlugin.AUDIO_READY, this.readyHandler, !1), i.addEventListener(gg7.HTMLAudioPlugin.AUDIO_STALLED, this.stalledHandler, !1), i.load()) : this.handleSoundReady(null), 1) } }, handleSoundStalled: function () { this.onPlayFailed != null && this.onPlayFailed(this), this.cleanUp() }, handleSoundReady: function () { window.gg7 != null && ((this.playState = gg7.SoundJS.PLAY_SUCCEEDED, this.paused = !1, this.tag.removeEventListener(gg7.HTMLAudioPlugin.AUDIO_READY, this.readyHandler, !1), this.offset >= this.getDuration()) ? this.playFailed() : (this.offset > 0 && (this.tag.currentTime = this.offset * .001), this.remainingLoops == -1 && (this.tag.loop = !0), this.tag.play())) }, pause: function () { return this.paused = !0, this.tag != null ? (this.tag.pause(), !1) : !0 }, resume: function () { return this.paused = !1, this.tag != null ? (this.tag.play(), !1) : !0 }, stop: function () { return this.pause(), this.playState = gg7.SoundJS.PLAY_FINISHED, this.cleanUp(), !0 }, setMasterVolume: function () { return this.updateVolume(), !0 }, setVolume: function (e) { return this.volume = e, this.updateVolume(), !0 }, updateVolume: function () { return this.tag != null ? (this.tag.volume = this.muted ? 0 : this.volume * gg7.SoundJS.masterVolume, !0) : !1 }, getVolume: function () { return this.volume }, mute: function (e) { return this.muted = e, this.updateVolume(), !0 }, setPan: function () { return !1 }, getPan: function () { return 0 }, getPosition: function () { return this.tag == null ? 0 : this.tag.currentTime * 1e3 }, setPosition: function (e) { if (this.tag == null) return !1; try { this.tag.currentTime = e * .001 } catch (t) { return !1 } return !0 }, getDuration: function () { return this.tag == null ? 0 : this.tag.duration * 1e3 }, handleSoundComplete: function () { this.remainingLoops != 0 ? (this.remainingLoops--, this.tag.play(), this.onLoop != null) && this.onLoop(this) : window.gg7 != null && (this.playState = gg7.SoundJS.PLAY_FINISHED, this.onComplete != null && this.onComplete(this), this.cleanUp()) }, playFailed: function () { window.gg7 != null && (this.playState = gg7.SoundJS.PLAY_FAILED, this.onPlayFailed != null && this.onPlayFailed(this), this.cleanUp()) }, toString: function () { return "[HTMLAudioPlugin SoundInstance]" } }, n.channels = {}, n.get = function (e) { var t = n.channels[e]; return t == null && (t = n.channels[e] = new n(e)), t }, n.getInstance = function (e) { return e = n.channels[e], e == null ? null : e.get() }, n.setInstance = function (e, t) { var r = n.channels[e]; return r == null ? null : r.set(t) }, n.prototype = { src: null, length: 0, available: 0, tags: null, init: function (e) { this.src = e, this.tags = [] }, add: function (e) { this.tags.push(e), this.length++, this.available = this.tags.length }, get: function () { if (this.tags.length == 0) return null; this.available = this.tags.length; var e = this.tags.pop(); return document.body.appendChild(e), e }, set: function (e) { this.tags.indexOf(e) == -1 && this.tags.push(e), document.body.gg4(e), this.available = this.tags.length }, toString: function () { return "[HTMLAudioPlugin TagChannel]" } } } (), this.gg7 = this.gg7 || {}, function () { var e = function (e, t) { this.initialize(e, t) }, t = e.prototype; e.NONE = 0, e.LOOP = 1, e.REVERSE = 2, e.IGNORE = {}, e._tweens = [], e._plugins = {}, e.get = function (t, n, r) { return new e(t, n, r) }, e.tick = function (t, n) { for (var r = e._tweens.slice(), i = r.length - 1; i >= 0; i--) { var s = r[i]; n && !s.ignoreGlobalPause || s._paused || s.tick(s._useTicks ? 1 : t) } }, gg7.gg2 && gg7.gg2.addListener(e, !1), e.removegkk4s = function (t) { if (t.tweenjs_count) { for (var n = e._tweens, r = n.length - 1; r >= 0; r--) n[r]._target == t && (n[r]._paused = !0, n.splice(r, 1)); t.tweenjs_count = 0 } }, e.hasActivegkk4s = function (t) { return t ? t.tweenjs_count : e._tweens && e._tweens.length }, e.installPlugin = function (t, n) { var r = t.priority; r == null && (t.priority = r = 0); for (var i = 0, s = n.length, o = e._plugins; i < s; i++) { var u = n[i]; if (o[u]) { for (var a = o[u], f = 0, l = a.length; f < l; f++) if (r < a[f].priority) break; o[u].splice(f, 0, t) } else o[u] = [t] } }, e._register = function (t, n) { var r = t._target; n ? (r && (r.tweenjs_count = r.tweenjs_count ? r.tweenjs_count + 1 : 1), e._tweens.push(t)) : (r && r.tweenjs_count--, r = e._tweens.indexOf(t), r != -1 && e._tweens.splice(r, 1)) }, t.ignoreGlobalPause = !1, t.loop = !1, t.duration = 0, t.pluginData = null, t.onChange = null, t.target = null, t.position = null, t._paused = !1, t._curQueueProps = null, t._initQueueProps = null, t._steps = null, t._actions = null, t._prevPosition = 0, t._stepPosition = 0, t._prevPos = -1, t._target = null, t._useTicks = !1, t.initialize = function (t, n, r) { this.target = this._target = t, n && (this._useTicks = n.useTicks, this.ignoreGlobalPause = n.ignoreGlobalPause, this.loop = n.loop, this.onChange = n.onChange, n.override && e.removegkk4s(t)), this.pluginData = r || {}, this._curQueueProps = {}, this._initQueueProps = {}, this._steps = [], this._actions = [], n && n.paused ? this._paused = !0 : e._register(this, !0), n && n.position != null && this.setPosition(n.position, e.NONE) }, t.wait = function (e) { if (e == null || e <= 0) return this; var t = this._cloneProps(this._curQueueProps); return this._addStep({ d: e, p0: t, e: this._linearEase, p1: t }) }, t.to = function (e, t, n) { if (isNaN(t) || t < 0) t = 0; return this._addStep({ d: t || 0, p0: this._cloneProps(this._curQueueProps), e: n, p1: this._cloneProps(this._appendQueueProps(e)) }) }, t.call = function (e, t, n) { return this._addAction({ f: e, p: t ? t : [this], o: n ? n : this._target }) }, t.set = function (e, t) { return this._addAction({ f: this._set, o: this, p: [e, t ? t : this._target] }) }, t.play = function (e) { return this.call(e.setPaused, [!1], e) }, t.pause = function (e) { return e || (e = this), this.call(e.setPaused, [!0], e) }, t.setPosition = function (e, t) { e < 0 && (e = 0), t == null && (t = 1); var n = e, r = !1; n >= this.duration && (this.loop ? n %= this.duration : (n = this.duration, r = !0)); if (n == this._prevPos) return r; if (this._target) if (r) this._updateTargetProps(null, 1); else if (this._steps.length > 0) { for (var i = 0, s = this._steps.length; i < s; i++) if (this._steps[i].t > n) break; i = this._steps[i - 1], this._updateTargetProps(i, (this._stepPosition = n - i.t) / i.d, n) } return i = this._prevPos, this.position = this._prevPos = n, this._prevPosition = e, t != 0 && this._actions.length > 0 && (this._useTicks ? this._runActions(n, n) : t == 1 && n < i ? (i != this.duration && this._runActions(i, this.duration), this._runActions(0, n, !0)) : this._runActions(i, n)), r && this.setPaused(!0), this.onChange && this.onChange(this), r }, t.tick = function (e) { this._paused || this.setPosition(this._prevPosition + e) }, t.setPaused = function (t) { return this._paused = !!t, e._register(this, !t), this }, t.w = t.wait, t.t = t.to, t.c = t.call, t.s = t.set, t.toString = function () { return "[gkk4]" }, t.clone = function () { throw "gkk4 can not be cloned." }, t._updateTargetProps = function (t, r, i) { var s, o, u, a; !t && r == 1 ? s = o = this._curQueueProps : (t.e && (r = t.e(r, 0, 1, 1)), s = t.p0, o = t.p1); for (n in this._initQueueProps) { (u = s[n]) == null && (s[n] = u = this._initQueueProps[n]), (a = o[n]) == null && (o[n] = a = u), u = u == a || r == 0 || r == 1 || typeof u != "number" ? r == 1 ? a : u : u + (a - u) * r; var f = !1; if (a = e._plugins[n]) for (var l = 0, c = a.length; l < c; l++) { var h = a[l].tween(this, n, u, s, o, r, i, !t); h == e.IGNORE ? f = !0 : u = h } f || (this._target[n] = u) } }, t._runActions = function (e, t, n) { var r = e, i = t, s = -1, o = this._actions.length, u = 1; for (e > t && (r = t, i = e, s = o, o = u = -1); (s += u) != o; ) { var t = this._actions[s], a = t.t; (a == i || a > r && a < i || n && a == e) && t.f.apply(t.o, t.p) } }, t._appendQueueProps = function (t) { var n, r, i, s; for (s in t) { if (this._initQueueProps[s] == null) { r = this._target[s]; if (n = e._plugins[s]) for (var o = 0, u = n.length; o < u; o++) i = n[o].init(this, s, r), i != e.IGNORE && (r = i); this._initQueueProps[s] = r } this._curQueueProps[s] = t[s] } return this._curQueueProps }, t._cloneProps = function (e) { var t = {}, n; for (n in e) t[n] = e[n]; return t }, t._addStep = function (e) { return e.d > 0 && (this._steps.push(e), e.t = this.duration, this.duration += e.d), this }, t._addAction = function (e) { return e.t = this.duration, this._actions.push(e), this }, t._set = function (e, t) { for (var n in e) t[n] = e[n] }, gg7.gkk4 = e } (), this.gg7 = this.gg7 || {}, function () { var e = function (e, t, n) { this.initialize(e, t, n) }, t = e.prototype; t.ignoreGlobalPause = !1, t.duration = 0, t.loop = !1, t.onChange = null, t.position = null, t._paused = !1, t._tweens = null, t._labels = null, t._prevPosition = 0, t._prevPos = -1, t._useTicks = !1, t.initialize = function (e, t, n) { this._tweens = [], n && (this._useTicks = n.useTicks, this.loop = n.loop, this.ignoreGlobalPause = n.ignoreGlobalPause, this.onChange = n.onChange), e && this.addgkk4.apply(this, e), this.setLabels(t), n && n.paused ? this._paused = !0 : gg7.gkk4._register(this, !0), n && n.position != null && this.setPosition(n.position, gg7.gkk4.NONE) }, t.addgkk4 = function (e) { var t = arguments.length; if (t > 1) { for (var n = 0; n < t; n++) this.addgkk4(arguments[n]); return arguments[0] } return t == 0 ? null : (this.removegkk4(e), this._tweens.push(e), e.setPaused(!0), e._paused = !1, e._useTicks = this._useTicks, e.duration > this.duration && (this.duration = e.duration), this._prevPos >= 0 && e.setPosition(this._prevPos, gg7.gkk4.NONE), e) }, t.removegkk4 = function (e) { var t = arguments.length; if (t > 1) { for (var n = !0, r = 0; r < t; r++) n = n && this.removegkk4(arguments[r]); return n } return t == 0 ? !1 : (t = this._tweens.indexOf(e), t != -1 ? (this._tweens.splice(t, 1), e.duration >= this.duration && this.updateDuration(), !0) : !1) }, t.addLabel = function (e, t) { this._labels[e] = t }, t.setLabels = function (e) { this._labels = e ? e : {} }, t.gg1 = function (e) { this.setPaused(!1), this._goto(e) }, t.gotoAndStop = function (e) { this.setPaused(!0), this._goto(e) }, t.setPosition = function (e, t) { e < 0 && (e = 0); var n = this.loop ? e % this.duration : e, r = !this.loop && e >= this.duration; if (n == this._prevPos) return r; this._prevPosition = e, this.position = this._prevPos = n; for (var i = 0, s = this._tweens.length; i < s; i++) if (this._tweens[i].setPosition(n, t), n != this._prevPos) return !1; return r && this.setPaused(!0), this.onChange && this.onChange(this), r }, t.setPaused = function (e) { this._paused = !!e, gg7.gkk4._register(this, !e) }, t.updateDuration = function () { for (var e = this.duration = 0, t = this._tweens.length; e < t; e++) if (tween = this._tweens[e], tween.duration > this.duration) this.duration = tween.duration }, t.tick = function (e) { this.setPosition(this._prevPosition + e) }, t.resolve = function (e) { var t = parseFloat(e); return isNaN(t) && (t = this._labels[e]), t }, t.toString = function () { return "[Timeline]" }, t.clone = function () { throw "Timeline can not be cloned." }, t._goto = function (e) { e = this.resolve(e), e != null && this.setPosition(e) }, gg7.Timeline = e } (), this.gg7 = this.gg7 || {}, function () { var e = function () { throw "Ease cannot be instantiated." }; e.linear = function (e) { return e }, e.none = e.linear, e.get = function (e) { return e < -1 && (e = -1), e > 1 && (e = 1), function (t) { return e == 0 ? t : e < 0 ? t * (t * -e + 1 + e) : t * ((2 - t) * e + (1 - e)) } }, e.getPowIn = function (e) { return function (t) { return Math.pow(t, e) } }, e.getPowOut = function (e) { return function (t) { return 1 - Math.pow(1 - t, e) } }, e.getPowInOut = function (e) { return function (t) { return (t *= 2) < 1 ? .5 * Math.pow(t, e) : 1 - .5 * Math.abs(Math.pow(2 - t, e)) } }, e.quadIn = e.getPowIn(2), e.quadOut = e.getPowOut(2), e.quadInOut = e.getPowInOut(2), e.cubicIn = e.getPowIn(3), e.cubicOut = e.getPowOut(3), e.cubicInOut = e.getPowInOut(3), e.quartIn = e.getPowIn(4), e.quartOut = e.getPowOut(4), e.quartInOut = e.getPowInOut(4), e.quintIn = e.getPowIn(5), e.quintOut = e.getPowOut(5), e.quintInOut = e.getPowInOut(5), e.sineIn = function (e) { return 1 - Math.cos(e * Math.PI / 2) }, e.sineOut = function (e) { return Math.sin(e * Math.PI / 2) }, e.sineInOut = function (e) { return -0.5 * (Math.cos(Math.PI * e) - 1) }, e.getBackIn = function (e) { return function (t) { return t * t * ((e + 1) * t - e) } }, e.backIn = e.getBackIn(1.7), e.getBackOut = function (e) { return function (t) { return --t * t * ((e + 1) * t + e) + 1 } }, e.backOut = e.getBackOut(1.7), e.getBackInOut = function (e) { return e *= 1.525, function (t) { return (t *= 2) < 1 ? .5 * t * t * ((e + 1) * t - e) : .5 * ((t -= 2) * t * ((e + 1) * t + e) + 2) } }, e.backInOut = e.getBackInOut(1.7), e.circIn = function (e) { return -(Math.sqrt(1 - e * e) - 1) }, e.circOut = function (e) { return Math.sqrt(1 - --e * e) }, e.circInOut = function (e) { return (e *= 2) < 1 ? -0.5 * (Math.sqrt(1 - e * e) - 1) : .5 * (Math.sqrt(1 - (e -= 2) * e) + 1) }, e.bounceIn = function (t) { return 1 - e.bounceOut(1 - t) }, e.bounceOut = function (e) { return e < 1 / 2.75 ? 7.5625 * e * e : e < 2 / 2.75 ? 7.5625 * (e -= 1.5 / 2.75) * e + .75 : e < 2.5 / 2.75 ? 7.5625 * (e -= 2.25 / 2.75) * e + .9375 : 7.5625 * (e -= 2.625 / 2.75) * e + .984375 }, e.bounceInOut = function (t) { return t < .5 ? e.bounceIn(t * 2) * .5 : e.bounceOut(t * 2 - 1) * .5 + .5 }, e.getElasticIn = function (e, t) { var n = Math.PI * 2; return function (r) { if (r == 0 || r == 1) return r; var i = t / n * Math.asin(1 / e); return -(e * Math.pow(2, 10 * (r -= 1)) * Math.sin((r - i) * n / t)) } }, e.elasticIn = e.getElasticIn(1, .3), e.getElasticOut = function (e, t) { var n = Math.PI * 2; return function (r) { if (r == 0 || r == 1) return r; var i = t / n * Math.asin(1 / e); return e * Math.pow(2, -10 * r) * Math.sin((r - i) * n / t) + 1 } }, e.elasticOut = e.getElasticOut(1, .3), e.getElasticInOut = function (e, t) { var n = Math.PI * 2; return function (r) { var i = t / n * Math.asin(1 / e); return (r *= 2) < 1 ? -0.5 * e * Math.pow(2, 10 * (r -= 1)) * Math.sin((r - i) * n / t) : e * Math.pow(2, -10 * (r -= 1)) * Math.sin((r - i) * n / t) * .5 + 1 } }, e.elasticInOut = e.getElasticInOut(1, .3 * 1.5), gg7.Ease = e } (); var e = { loadXml: function (e, t) { $.ajax({ type: "GET", url: "config/" + e, dataType: "xml", success: t }) }, pW: function (e) { return document.getElementById("gameCanvas").width / 100 * e }, pH: function (e) { return document.getElementById("gameCanvas").height / 100 * e } }, t = { ResList: {} }; t.getRes = function (e) { return t.ResList[e] ? t.ResList[e] : t.getPath(e) }, t.getJSON = function (e) { var n = JSON.parse(t.getRes(e + "JSON")); return n.images = [t.getRes(e)], n }, t.getBitmap = function (e, n) { var r = new gg7.Bitmap(t.ResList[e]); if (n) { var i = t.getRes(e + "Config"); $(i).find("sprite").each(function () { var e = $(this); e.attr("n") == n && (r.gkk3 = new gg7.fcnaaf(e.attr("x"), e.attr("y"), e.attr("w"), e.attr("h")), r.regX = -e.attr("oX"), r.regY = -e.attr("oY")) }) } return r }, t.getFrames = function (e) { var n = [], e = t.getRes(e + "Config"); if ($(e).find("offset").length > 0) { var r = $(e).find("offset").attr("offsetX"), i = $(e).find("offset").attr("offsetY"); $(e).find("sprite").each(function () { var e = $(this), e = [e.attr("x"), e.attr("y"), e.attr("w"), e.attr("h"), 0, r, i]; n.push(e) }) } else $(e).find("sprite").each(function () { var e = $(this), e = [e.attr("x"), e.attr("y"), e.attr("w"), e.attr("h"), 0, e.attr("w") / 2, e.attr("h")]; n.push(e) }); return n }, t.getCenterFrames = function (e) {
    var n = [], e = t.getRes(e + "Config"); return $(e).find("sprite").each(function () {
        var e = $(this), e = [e.attr("x"), e.attr("y"), e.attr("w"), e.attr("h"), 0, e.attr("w") / 2, e.attr("h") / 2]; n.push
(e)
    }), n
}, t.getFramesNoReg = function (e, n) { var r = [], i, s = t.getRes(e + "Config"); return $(s).find("sprite").each(function () { var e = $(this), t = {}; t.id = e.attr("n"), t.value = [e.attr("x"), e.attr("y"), e.attr("w"), e.attr("h")], t.id == n && (i = t.value), r.push(t) }), frame.id ? i : r }, t.getFramesAndId = function (e, n) { var r = [], i, s = t.getRes(e + "Config"); return $(s).find("sprite").each(function () { var e = $(this), t = {}; t.id = e.attr("n"), t.value = [e.attr("x"), e.attr("y"), e.attr("w"), e.attr("h"), 0, -e.attr("oX"), -e.attr("oY")], t.id == n && (i = t.value), r.push(t) }), frame.id ? i : r }, t.addRes = function (e, n) { t.ResList[e] = n }, t.getPath = function (e) { var t = ""; return $(a.assetsXML).find("asset").each(function () { $(this).attr("id") === e && (t = "assets/" + $(this).parent()[0].nodeName + "/" + $(this).attr("url")) }), t }, function (e) { var t = function (e, t, n) { this.initialize(e, t, n) }, n = t.prototype = new e.Filter; n.initialize = function (e, t, n) { if (isNaN(e) || e < 0) e = 0; this.blurX = e | 0; if (isNaN(t) || t < 0) t = 0; this.blurY = t | 0; if (isNaN(n) || n < 1) n = 1; this.quality = n | 0 }, n.blurX = 0, n.blurY = 0, n.quality = 1, n.getBounds = function () { return new e.fcnaaf(-this.blurX, -this.blurY, 2 * this.blurX, 2 * this.blurY) }, n.applyFilter = function (e, t, n, r, i, s, o, u) { s = s || e, o == null && (o = t), u == null && (u = n); try { var a = e.getImageData(t, n, r, i) } catch (f) { return !1 } e = this.blurX; if (isNaN(e) || e < 0) return !1; e |= 0; var l = this.blurY; if (isNaN(l) || l < 0) return !1; l |= 0; if (e == 0 && l == 0) return !1; var c = this.quality; if (isNaN(c) || c < 1) c = 1; c |= 0, c > 3 && (c = 3), c < 1 && (c = 1); for (var h = a.data, p, d, v, m, g, y, b, w, E = r - 1, S = i - 1, x = e + 1, T = l + 1, N = 1 / ((e + x) * (l + T)), C = [], k = [], L = [], A = [], O = [], M = []; c-- > 0; ) { for (n = w = b = 0; n < i; n++) { p = h[w] * x, d = h[w + 1] * x, v = h[w + 2] * x, m = h[w + 3] * x; for (g = 1; g <= e; g++) t = w + ((g > E ? E : g) << 2), p += h[t++], d += h[t++], v += h[t++], m += h[t]; for (t = 0; t < r; t++) C[b] = p, k[b] = d, L[b] = v, A[b] = m, n == 0 && (O[t] = Math.min(t + x, E) << 2, M[t] = Math.max(t - e, 0) << 2), g = w + O[t], y = w + M[t], p += h[g++] - h[y++], d += h[g++] - h[y++], v += h[g++] - h[y++], m += h[g] - h[y], b++; w += r << 2 } for (t = 0; t < r; t++) { n = t, p = C[n] * T, d = k[n] * T, v = L[n] * T, m = A[n] * T; for (g = 1; g <= l; g++) n += g > S ? 0 : r, p += C[n], d += k[n], v += L[n], m += A[n]; b = t << 2; for (n = 0; n < i; n++) h[b] = p * N + .5 | 0, h[b + 1] = d * N + .5 | 0, h[b + 2] = v * N + .5 | 0, h[b + 3] = m * N + .5 | 0, t == 0 && (O[n] = Math.min(n + T, S) * r, M[n] = Math.max(n - l, 0) * r), g = t + O[n], y = t + M[n], p += C[g] - C[y], d += k[g] - k[y], v += L[g] - L[y], m += A[g] - A[y], b += r << 2 } } return s.putImageData(a, o, u), !0 }, n.clone = function () { return new t(this.blurX, this.blurY, this.quality) }, n.toString = function () { return "[BoxBlurFilter]" }, e.BoxBlurFilter = t } (gg7 || (gg7 = {})); var gg7; (function (e) { var t = function (e, t, n, r, i, s, o, u) { this.initialize(e, t, n, r, i, s, o, u) }, n = t.prototype = new e.Filter; n.redMultiplier = 1, n.greenMultiplier = 1, n.blueMultiplier = 1, n.alphaMultiplier = 1, n.redOffset = 0, n.greenOffset = 0, n.blueOffset = 0, n.alphaOffset = 0, n.initialize = function (e, t, n, r, i, s, o, u) { this.redMultiplier = e != null ? e : 1, this.greenMultiplier = t != null ? t : 1, this.blueMultiplier = n != null ? n : 1, this.alphaMultiplier = r != null ? r : 1, this.redOffset = i || 0, this.greenOffset = s || 0, this.blueOffset = o || 0, this.alphaOffset = u || 0 }, n.applyFilter = function (e, t, n, r, i, s, o, u) { s = s || e, o == null && (o = t), u == null && (u = n); try { var a = e.getImageData(t, n, r, i) } catch (f) { return !1 } e = a.data, t = e.length; for (n = 0; n < t; n += 4) e[n] = e[n] * this.redMultiplier + this.redOffset, e[n + 1] = e[n + 1] * this.greenMultiplier + this.greenOffset, e[n + 2] = e[n + 2] * this.blueMultiplier + this.blueOffset, e[n + 3] = e[n + 3] * this.alphaMultiplier + this.alphaOffset; return a.data = e, s.putImageData(a, o, u), !0 }, n.toString = function () { return "[ColorFilter]" }, n.clone = function () { return new t(this.redMultiplier, this.greenMultiplier, this.blueMultiplier, this.alphaMultiplier, this.redOffset, this.greenOffset, this.blueOffset, this.alphaOffset) }, e.ColorFilter = t })(gg7 || (gg7 = {})), function (e) { ColorMatrix = function (e, t, n, r) { this.initialize(e, t, n, r) }; var t = ColorMatrix.prototype = []; ColorMatrix.DELTA_INDEX = [0, .01, .02, .04, .05, .06, .07, .08, .1, .11, .12, .14, .15, .16, .17, .18, .2, .21, .22, .24, .25, .27, .28, .3, .32, .34, .36, .38, .4, .42, .44, .46, .48, .5, .53, .56, .59, .62, .65, .68, .71, .74, .77, .8, .83, .86, .89, .92, .95, .98, 1, 1.06, 1.12, 1.18, 1.24, 1.3, 1.36, 1.42, 1.48, 1.54, 1.6, 1.66, 1.72, 1.78, 1.84, 1.9, 1.96, 2, 2.12, 2.25, 2.37, 2.5, 2.62, 2.75, 2.87, 3, 3.2, 3.4, 3.6, 3.8, 4, 4.3, 4.7, 4.9, 5, 5.5, 6, 6.5, 6.8, 7, 7.3, 7.5, 7.8, 8, 8.4, 8.7, 9, 9.4, 9.6, 9.8, 10], ColorMatrix.IDENTITY_MATRIX = [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1], ColorMatrix.LENGTH = ColorMatrix.IDENTITY_MATRIX.length, t.initialize = function (e, t, n, r) { return this.reset(), this.adjustColor(e, t, n, r), this }, t.reset = function () { return this.copyMatrix(ColorMatrix.IDENTITY_MATRIX) }, t.adjustColor = function (e, t, n, r) { return this.adjustHue(r), this.adjustContrast(t), this.adjustBrightness(e), this.adjustSaturation(n) }, t.adjustBrightness = function (e) { return e == 0 || isNaN(e) ? this : (e = this._cleanValue(e, 255), this._multiplyMatrix([1, 0, 0, 0, e, 0, 1, 0, 0, e, 0, 0, 1, 0, e, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]), this) }, t.adjustContrast = function (e) { if (e == 0 || isNaN(e)) return this; var e = this._cleanValue(e, 100), t; return e < 0 ? t = 127 + e / 100 * 127 : (t = e % 1, t = t == 0 ? ColorMatrix.DELTA_INDEX[e] : ColorMatrix.DELTA_INDEX[e << 0] * (1 - t) + ColorMatrix.DELTA_INDEX[(e << 0) + 1] * t, t = t * 127 + 127), this._multiplyMatrix([t / 127, 0, 0, 0, .5 * (127 - t), 0, t / 127, 0, 0, .5 * (127 - t), 0, 0, t / 127, 0, .5 * (127 - t), 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]), this }, t.adjustSaturation = function (e) { return e == 0 || isNaN(e) ? this : (e = this._cleanValue(e, 100), e = 1 + (e > 0 ? 3 * e / 100 : e / 100), this._multiplyMatrix([.3086 * (1 - e) + e, .6094 * (1 - e), .082 * (1 - e), 0, 0, .3086 * (1 - e), .6094 * (1 - e) + e, .082 * (1 - e), 0, 0, .3086 * (1 - e), .6094 * (1 - e), .082 * (1 - e) + e, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]), this) }, t.adjustHue = function (e) { if (e == 0 || isNaN(e)) return this; var e = this._cleanValue(e, 180) / 180 * Math.PI, t = Math.cos(e), e = Math.sin(e); return this._multiplyMatrix([.213 + t * .787 + e * -0.213, .715 + t * -0.715 + e * -0.715, .072 + t * -0.072 + e * .928, 0, 0, .213 + t * -0.213 + e * .143, .715 + t * (1 - .715) + e * .14, .072 + t * -0.072 + e * -0.283, 0, 0, .213 + t * -0.213 + e * -0.787, .715 + t * -0.715 + e * .715, .072 + t * .928 + e * .072, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]), this }, t.concat = function (e) { return e = this._fixMatrix(e), e.length != ColorMatrix.LENGTH ? this : (this._multiplyMatrix(e), this) }, t.clone = function () { return new ColorMatrix(this) }, t.toArray = function () { return this.slice(0, ColorMatrix.LENGTH) }, t.copyMatrix = function (e) { for (var t = ColorMatrix.LENGTH, n = 0; n < t; n++) this[n] = e[n]; return this }, t._multiplyMatrix = function (e) { for (var t = [], n = 0; n < 5; n++) { for (var r = 0; r < 5; r++) t[r] = this[r + n * 5]; for (r = 0; r < 5; r++) { for (var i = 0, s = 0; s < 5; s++) i += e[r + s * 5] * t[s]; this[r + n * 5] = i } } }, t._cleanValue = function (e, t) { return Math.min(t, Math.max(-t, e)) }, t._fixMatrix = function (e) { return e instanceof ColorMatrix && (e = e.slice(0)), e.length < ColorMatrix.LENGTH ? e = e.slice(0, e.length).concat(ColorMatrix.IDENTITY_MATRIX.slice(e.length, ColorMatrix.LENGTH)) : e.length > ColorMatrix.LENGTH && (e = e.slice(0, ColorMatrix.LENGTH)), e }, e.ColorMatrix = ColorMatrix } (gg7 || (gg7 = {})), function (e) { var t = function (e) { this.initialize(e) }, n = t.prototype = new e.Filter; n.matrix = null, n.initialize = function (e) { this.matrix = e }, n.applyFilter = function (e, t, n, r, i, s, o, u) { s = s || e, o == null && (o = t), u == null && (u = n); try { var a = e.getImageData(t, n, r, i) } catch (f) { return !1 } var e = a.data, t = e.length, l, c, h, p; l = this.matrix; for (var n = l[0], r = l[1], i = l[2], d = l[3], v = l[4], m = l[5], g = l[6], y = l[7], b = l[8], w = l[9], E = l[10], S = l[11], x = l[12], T = l[13], N = l[14], C = l[15], k = l[16], L = l[17], A = l[18], O = l[19], M = 0; M < t; M += 4) l = e[M], c = e[M + 1], h = e[M + 2], p = e[M + 3], e[M] = l * n + c * r + h * i + p * d + v, e[M + 1] = l * m + c * g + h * y + p * b + w, e[M + 2] = l * E + c * S + h * x + p * T + N, e[M + 3] = l * C + c * k + h * L + p * A + O; return a.data = e, s.putImageData(a, o, u), !0 }, n.toString = function () { return "[ColorMatrixFilter]" }, n.clone = function () { return new t(this.matrix) }, e.ColorMatrixFilter = t } (gg7 || (gg7 = {})), r.prototype = new gg7.gg6, r.prototype.gg6_initialize = r.prototype.initialize, r.prototype.initialize = function (e) { this.gg6_initialize(), this.blur = t.getBitmap("blur"), this.blur.regX = 64, this.blur.regY = 64; var n = new gg7.ColorMatrix; n.adjustColor(10, 10, 0, 0); var n = new gg7.ColorMatrixFilter(n), r = new gg7.BoxBlurFilter(0, 0, 2), i = new gg7.ColorFilter(1, 1, 1, 1), s = new gg7.ColorFilter(1, 200 / 255, 1, 1), o = new gg7.ColorFilter(1, 1, 50 / 255, 1); this.blur.filters = [n, r, i, s, o], this.blur.alpha = .5, this.blur.cache(0, 0, this.blur.image.width, this.blur.image.height), this.adcg1(this.blur), this.boxBitmap = t.getBitmap("treasurechest"), this.boxBitmap.gkk3 = new gg7.fcnaaf(0, 0, 64, 64), this.boxBitmap.regX = 32, this.boxBitmap.regY = 32, this.adcg1(this.boxBitmap), this.x = e.x * 64 + 32, this.y = e.y * 64 + 32, gg7.gg2.addListener(this), e = new gg7.gg5({ images: [t.getRes("treasurechest")], frames: { width: 64, height: 64, regX: 32, regY: 32 }, animations: { open: { frames: [2, 1, 4, 5, 8, 9, 11], next: "", frequency: 10}} }), this.aabb = new l(this.x - 32, this.y - 32, 64, 64); var u = this; this.bmpAnim = new gg7.gg8(e), this.bmpAnim.onAnimationEnd = function () { this.gg9 == "open" && (u.gg4(u.blur), gg7.gg2.gg3(u)) }, this.adcg1(this.bmpAnim) }, r.prototype.tick = function () { this.blur.rotation += .5 }, r.prototype.open = function () { this.bmpAnim.gg9 != "open" && this.bmpAnim.gg1("open") }, i.prototype = new gg7.gg6, i.prototype.gg6_initialize = i.prototype.initialize, i.prototype.initialize = function (e) { this.gg6_initialize(); var n = new gg7.gg5({ images: [t.getRes("Furniture")], frames: [[13, 330, 41, 39, 0, 19, 20], [77, 330, 41, 39, 0, 19, 20], [141, 330, 41, 39, 0, 19, 20], [205, 330, 41, 39, 0, 19, 20]], animations: { show: [0, 3, "show", 10]} }); this.bmpAnim = new gg7.gg8(n), this.bmpAnim.gg1("show"), this.x = e.x * 64 + 32, this.y = e.y * 64 + 32, this.adcg1(this.bmpAnim) }, i.prototype.tick = function () { }, s.prototype = new gg7.gg6, s.prototype.gg6_initialize = s.prototype.initialize, s.prototype.initialize = function (e) { this.gg6_initialize(); var n = new gg7.gg5({ images: [t.getRes("Furniture")], frames: [[262, 266, 55, 45, 0, 25.5, 20], [324, 266, 55, 45, 0, 27.5, 20], [390, 267, 55, 45, 0, 25.5, 19], [452, 267, 55, 45, 0, 27.5, 19]], animations: { show: [0, 3, "show", 10]} }); this.bmpAnim = new gg7.gg8(n), this.bmpAnim.gg1("show"), this.x = e.x * 64 + 32, this.y = e.y * 64 + 32, this.adcg1(this.bmpAnim) }, s.prototype.tick = function () { }, function (e) { var t = function (e, t) { this.initialize(e, t) }; t.prototype = { initialize: function (e, t) { this.x = e || 0, this.y = t || 0 }, set: function (e, t) { return this.x = e, this.y = t, this }, sub: function (e) { return new t(this.x - e.x, this.y - e.y) }, subSelf: function (e) { this.x -= e.x, this.y -= e.y }, add: function (e) { return new t(this.x + e.x, this.y + e.y) }, addSelf: function (e) { this.x += e.x, this.y += e.y }, multiplyScalar: function (e) { return this.x *= e, this.y *= e, this }, divideScalar: function (e) { return e ? (this.x /= e, this.y /= e) : this.set(0, 0), this }, rotateSelf: function (e, t) { var n = this.sub(e); t *= Math.PI / 180; var r = [[Math.cos(t), -Math.sin(t)], [Math.sin(t), Math.cos(t)]]; this.x = e.x + r[0][0] * n.x + r[0][1] * n.y, this.y = e.y + r[1][0] * n.x + r[1][1] * n.y }, rotate: function (e, n) { var r = this.sub(e); n *= Math.PI / 180; var i = [[Math.cos(n), -Math.sin(n)], [Math.sin(n), Math.cos(n)]]; return new t(e.x + i[0][0] * r.x + i[0][1] * r.y, e.y + i[1][0] * r.x + i[1][1] * r.y) }, length: function () { return Math.sqrt(this.lengthSq()) }, normalize: function () { return this.divideScalar(this.length()) }, lengthSq: function () { return this.x * this.x + this.y * this.y }, distanceToSquared: function (e) { var t = this.x - e.x, e = this.y - e.y; return t * t + e * e }, distanceTo: function (e) { return Math.sqrt(this.distanceToSquared(e)) }, setLength: function (e) { return this.normalize().multiplyScalar(e) }, dot: function (e) { return this.x * e.x + this.y * e.y } }, e.Vector2 = t } (window); var o = function (e) { this.map = this.mapBak = e, this.chkList = [], this.openList = [], this.getG = function (e, t, n, r) { return Math.abs(e - n) == 1 && Math.abs(t - r) == 1 ? 14 : 10 }, this.getH = function (e, t, n, r) { return e = Math.abs(e - n), t = Math.abs(t - r), e > t ? 14 * t + 10 * (e - t) : 14 * e + 10 * (t - e) }, this.point = function (e, t, n, r, i, s) { this.f = e, this.g = t, this.h = n, this.x = r, this.y = i, this.p = s }, this.setPoints = function (e, t, n) { var r = this.map, i = e.x, s = e.y, o = e.g, u = i - 1, a = i + 1, f = s - 1, l = s + 1, c = r.length, h = r[0].length; u >= 0 && r[u][s] == 0 && this.chkPoint(e, i, s, o, i - 1, s, t, n), f >= 0 && r[i][f] == 0 && this.chkPoint(e, i, s, o, i, s - 1, t, n), l < h && r[i][l] == 0 && this.chkPoint(e, i, s, o, i, s + 1, t, n), a < c && r[a][s] == 0 && this.chkPoint(e, i, s, o, i + 1, s, t, n) }, this.chkPoint = function (e, t, n, r, i, s, o, u) { var a = this.openList, f = this.chkList, l = new String(i + "_" + s), c = null; if (void 0 == (c = f[l])) c = new this.point(0, 0, 0, i, s, e), a[a.length] = c, f[l] = c, c.g = r + this.getG(t, n, i, s), c.h = this.getH(i, s, o, u), c.f = c.g + c.h; else if (t = r + this.getG(t, n, i, s), c.g > t) c.g = t, c.f = c.g + c.h, c.p = e }, this.getPath = function (e, t, n, r) { var i = [], s = this.openList, o = this.map; if (o[e][t] != 0 || o[n][r] != 0) return i; o = this.getH(e, t, n, r), s[0] = new this.point(o, 0, o, e, t, null); for (var o = 0, u = null; 0 < (o = s.length); ) { for (var a, f = 1e10, l = 0; l < o; l++) if (u = s[l], f > u.f) f = u.f, a = l; u = s[a], s[a] = s[o - 1], s.length--; if (u.x == n && u.y == r) { for (; u.p != null; ) i.push([u.x, u.y]), u = u.p; i.push([e, t]); break } this.setPoints(u, n, r) } return this.openList = this.chkList = [], i.slice(0).reverse() } }; u.prototype = new gg7.gg6, u.prototype.gg6_initialize = u.prototype.initialize, u.prototype.initialize = function (e) { this.gg6_initialize(); var n = t.getBitmap("shadowmap"); n.regX = 25, n.regY = 40, n.gkk3 = new gg7.fcnaaf(128, 64, 64, 64), this.adcg1(n), n = new gg7.gg5({ images: [t.getRes("hero-m")], frames: { width: 64, height: 64, numFrames: 32, regX: 32, regY: 45 }, animations: { walk1: [0, 7, "walk1", 5], walk4: [8, 15, "walk4", 5], walk3: [16, 23, "walk3", 5], stand1: [0, 0, "stand1", 100], stand4: [8, 8, "stand4", 100], stand3: [16, 16, "stand3", 100], win: [28, 31, "win", 10], lose: [25, 25, "lose", 100]} }), gg7.gg5Utils.addFlippedFrames(n, !0, !1, !1), this.bmpAnim = new gg7.gg8(n), this.currentCell = e, this.x = e.x * 64 + 32, this.y = e.y * 64 + 32, this.speed = 2, this.dir = 3, this.stand(), this.adcg1(this.bmpAnim), this.path = [], gg7.gg2.addListener(this), this.aabb = new l(this.x - 16, this.y - 26, 32, 50), this.debuggerRect = new gg7.Shape }, u.prototype.tick = function () { this.debuggerRect.graphics.clear(), this.debuggerRect.graphics.beginStroke("#F00").drawRect(-16, -26, this.aabb.width, this.aabb.height); if (this.path.length > 0) { var e = this.path[0], t = new Vector2(e[0], e[1]), e = new Vector2(t.x * 64 + 32, t.y * 64 + 32), n = e.sub(new Vector2(this.x, this.y)).setLength(this.speed); this.setDirection(t), this.walk(), this.x += n.x, this.y += n.y, this.aabb = new l(this.x - 16, this.y - 26, 32, 50), t = this.aabb.GetIntersectionDepth(a.box.aabb); if (t.x != 0 || t.y != 0) a.box.open(), a.exit.open(); a.exit.isOpen && (t = this.aabb.GetIntersectionDepth(a.exit.aabb), t.x != 0 || t.y != 0) && (gg7.gg2.gg3(this), a.showWin(), this.win()); if ((new Vector2(this.x, this.y)).distanceToSquared(e) < 25 || n.x === 0 && n.y === 0) this.path.shift(), a.footPrintCTT.gg4At(0), this.currentCell = new Vector2(parseInt(this.x / 64), parseInt(this.y / 64)) } else this.stand() }, u.prototype.setDirection = function (e) { var t = e.x - this.currentCell.x, e = e.y - this.currentCell.y; t === 0 && e < 0 && (this.dir = 1), t > 0 && e === 0 && (this.dir = 2), t === 0 && e > 0 && (this.dir = 3), t < 0 && e === 0 && (this.dir = 4) }, u.prototype.walk = function () { this.bmpAnim.gg9 != "walk" + this.getFrameName() && this.bmpAnim.gg1("walk" + this.getFrameName()) }, u.prototype.stand = function () { this.bmpAnim.gg9 != "stand" + this.getFrameName() && this.bmpAnim.gg1("stand" + this.getFrameName()) }, u.prototype.win = function () { this.bmpAnim.gg9 != "win" && this.bmpAnim.gg1("win") }, u.prototype.lose = function () { this.bmpAnim.gg9 != "lose" && this.bmpAnim.gg1("lose") }, u.prototype.getFrameName = function () { if (this.dir == 1) return "1"; if (this.dir == 2) return "4_h"; if (this.dir == 3) return "3"; if (this.dir == 4) return "4" }; var a = {}; a = new f, a.init(), l.prototype = new gg7.fcnaaf, l.prototype.fcnaaf_initialize = l.prototype.initialize, l.prototype.initialize = function (e, t, n, r) { this.fcnaaf_initialize(e, t, n, r), this.Location = new Vector2(this.x, this.y), this.Center = new Vector2(parseInt(this.x + this.width / 2), parseInt(this.y + this.height / 2)) }, l.prototype.setX = function (e) { this.initialize(e, this.y, this.width, this.height) }, l.prototype.setY = function (e) { this.initialize(this.x, e, this.width, this.height) }, l.prototype.setWidth = function (e) { this.initialize(this.x, this.y, e, this.height) }, l.prototype.setHeight = function (e) { this.initialize(this.x, this.y, this.width, e) }, l.prototype.Left = function () { return parseInt(this.x) }, l.prototype.Right = function () { return parseInt(this.x + this.width) }, l.prototype.Top = function () { return parseInt(this.y) }, l.prototype.Bottom = function () { return parseInt(this.y + this.height) }, l.prototype.Contains = function (e) { return this.x <= e.x && e.x + e.width <= this.x + this.width && this.y <= e.y ? e.y + e.height <= this.y + this.height : !1 }, l.prototype.ContainsPoint = function (e) { return this.x <= e.x && e.x < this.x + this.width && this.y <= e.y ? e.y < this.y + this.height : !1 }, l.prototype.Intersects = function (e) { return e.x < this.x + this.width && this.x < e.x + e.width && e.y < this.y + this.height ? this.y < e.y + e.height : !1 }, l.prototype.GetBottomCenter = function () { return new Vector2(parseInt(this.x + this.width / 2), this.Bottom()) }, l.prototype.GetIntersectionDepth = function (e) { var t = this.width / 2, n = this.height / 2, r = e.width / 2, i = e.height / 2, s = new Vector2(this.Left() + t, this.Top() + n), o = new Vector2(e.Left() + r, e.Top() + i), e = s.x - o.x, s = s.y - o.y; return t += r, n += i, Math.abs(e) >= t || Math.abs(s) >= n ? new Vector2(0, 0) : new Vector2(e > 0 ? t - e : -t - e, s > 0 ? n - s : -n - s) }, c.prototype = new gg7.gg6, c.prototype.gg6_initialize = c.prototype.initialize, c.prototype.initialize = function (e) { this.gg6_initialize(), this.ExitBitmap = t.getBitmap("portcullis"), this.ExitBitmap.gkk3 = new gg7.fcnaaf(0, 0, 64, 64), this.ExitBitmap.regX = 32, this.ExitBitmap.regY = 32, this.adcg1(this.ExitBitmap), this.x = e.x * 64 + 32, this.y = e.y * 64 + 32, this.currentCell = e, e = new gg7.gg5({ images: [t.getRes("portcullis")], frames: { width: 64, height: 64, regX: 32, regY: 32 }, animations: { open: [0, 5, "", 10]} }), this.isOpen = !1, this.aabb = new l(this.x - 32, this.y - 32, 64, 64); var n = this; this.bmpAnim = new gg7.gg8(e), this.bmpAnim.onAnimationEnd = function () { this.gg9 == "open" && (n.isOpen = !0, a.mapData[n.currentCell.x][n.currentCell.y] = 0, a.astar = new o(a.mapData)) }, this.adcg1(this.bmpAnim) }, c.prototype.open = function () { this.bmpAnim.gg9 != "open" && this.bmpAnim.gg1("open") }, function () { function e(t, n, r) { if (t === n) return 0 !== t || 1 / t == 1 / n; if (null == t || null == n) return t === n; t._chain && (t = t._wrapped), n._chain && (n = n._wrapped); if (t.isEqual && E.isFunction(t.isEqual)) return t.isEqual(n); if (n.isEqual && E.isFunction(n.isEqual)) return n.isEqual(t); var i = a.call(t); if (i != a.call(n)) return !1; switch (i) { case "[object String]": return t == "" + n; case "[object Number]": return t != +t ? n != +n : 0 == t ? 1 / t == 1 / n : t == +n; case "[object Date]": case "[object Boolean]": return +t == +n; case "[object RegExp]": return t.source == n.source && t.global == n.global && t.multiline == n.multiline && t.ignoreCase == n.ignoreCase } if ("object" != typeof t || "object" != typeof n) return !1; for (var s = r.length; s--; ) if (r[s] == t) return !0; r.push(t); var s = 0, o = !0; if ("[object Array]" == i) { if (s = t.length, o = s == n.length) for (; s-- && (o = s in t == s in n && e(t[s], n[s], r)); ); } else { if ("constructor" in t != "constructor" in n || t.constructor != n.constructor) return !1; for (var u in t) if (E.has(t, u) && (s++, !(o = E.has(n, u) && e(t[u], n[u], r)))) break; if (o) { for (u in n) if (E.has(n, u) && !(s--)) break; o = !s } } return r.pop(), o } var t = this, n = t._, r = {}, i = Array.prototype, s = Object.prototype, o = i.slice, u = i.unshift, a = s.toString, f = s.hasOwnProperty, l = i.forEach, c = i.map, h = i.reduce, p = i.reduceRight, d = i.filter, v = i.every, m = i.some, g = i.indexOf, y = i.lastIndexOf, s = Array.isArray, b = Object.keys, w = Function.prototype.bind, E = function (e) { return new _(e) }; "undefined" != typeof exports ? ("undefined" != typeof module && module.exports && (exports = module.exports = E), exports._ = E) : t._ = E, E.VERSION = "1.3.3"; var S = E.each = E.forEach = function (e, t, n) { if (e != null) if (l && e.forEach === l) e.forEach(t, n); else if (e.length === +e.length) { for (var i = 0, s = e.length; i < s; i++) if (i in e && t.call(n, e[i], i, e) === r) break } else for (i in e) if (E.has(e, i) && t.call(n, e[i], i, e) === r) break }; E.map = E.collect = function (e, t, n) { var r = []; return e == null ? r : c && e.map === c ? e.map(t, n) : (S(e, function (e, i, s) { r[r.length] = t.call(n, e, i, s) }), e.length === +e.length && (r.length = e.length), r) }, E.reduce = E.foldl = E.inject = function (e, t, n, r) { var i = arguments.length > 2; e == null && (e = []); if (h && e.reduce === h) return r && (t = E.bind(t, r)), i ? e.reduce(t, n) : e.reduce(t); S(e, function (e, s, o) { i ? n = t.call(r, n, e, s, o) : (n = e, i = !0) }); if (!i) throw new TypeError("Reduce of empty array with no initial value"); return n }, E.reduceRight = E.foldr = function (e, t, n, r) { var i = arguments.length > 2; e == null && (e = []); if (p && e.reduceRight === p) return r && (t = E.bind(t, r)), i ? e.reduceRight(t, n) : e.reduceRight(t); var s = E.toArray(e).reverse(); return r && !i && (t = E.bind(t, r)), i ? E.reduce(s, t, n, r) : E.reduce(s, t) }, E.find = E.detect = function (e, t, n) { var r; return x(e, function (e, i, s) { if (t.call(n, e, i, s)) return r = e, !0 }), r }, E.filter = E.select = function (e, t, n) { var r = []; return e == null ? r : d && e.filter === d ? e.filter(t, n) : (S(e, function (e, i, s) { t.call(n, e, i, s) && (r[r.length] = e) }), r) }, E.reject = function (e, t, n) { var r = []; return e == null ? r : (S(e, function (e, i, s) { t.call(n, e, i, s) || (r[r.length] = e) }), r) }, E.every = E.all = function (e, t, n) { var i = !0; return e == null ? i : v && e.every === v ? e.every(t, n) : (S(e, function (e, s, o) { if (!(i = i && t.call(n, e, s, o))) return r }), !!i) }; var x = E.some = E.any = function (e, t, n) { t || (t = E.identity); var i = !1; return e == null ? i : m && e.some === m ? e.some(t, n) : (S(e, function (e, s, o) { if (i || (i = t.call(n, e, s, o))) return r }), !!i) }; E.include = E.contains = function (e, t) { var n; return e == null ? !1 : g && e.indexOf === g ? e.indexOf(t) != -1 : n = x(e, function (e) { return e === t }) }, E.invoke = function (e, t) { var n = o.call(arguments, 2); return E.map(e, function (e) { return (E.isFunction(t) ? t || e : e[t]).apply(e, n) }) }, E.pluck = function (e, t) { return E.map(e, function (e) { return e[t] }) }, E.max = function (e, t, n) { if (!t && E.isArray(e) && e[0] === +e[0]) return Math.max.apply(Math, e); if (!t && E.isEmpty(e)) return -Infinity; var r = { computed: -Infinity }; return S(e, function (e, i, s) { i = t ? t.call(n, e, i, s) : e, i >= r.computed && (r = { value: e, computed: i }) }), r.value }, E.min = function (e, t, n) { if (!t && E.isArray(e) && e[0] === +e[0]) return Math.min.apply(Math, e); if (!t && E.isEmpty(e)) return Infinity; var r = { computed: Infinity }; return S(e, function (e, i, s) { i = t ? t.call(n, e, i, s) : e, i < r.computed && (r = { value: e, computed: i }) }), r.value }, E.shuffle = function (e) { var t = [], n; return S(e, function (e, r) { n = Math.floor(Math.random() * (r + 1)), t[r] = t[n], t[n] = e }), t }, E.sortBy = function (e, t, n) { var r = E.isFunction(t) ? t : function (e) { return e[t] }; return E.pluck(E.map(e, function (e, t, i) { return { value: e, criteria: r.call(n, e, t, i)} }).sort(function (e, t) { var n = e.criteria, r = t.criteria; return n === void 0 ? 1 : r === void 0 ? -1 : n < r ? -1 : n > r ? 1 : 0 }), "value") }, E.groupBy = function (e, t) { var n = {}, r = E.isFunction(t) ? t : function (e) { return e[t] }; return S(e, function (e, t) { var i = r(e, t); (n[i] || (n[i] = [])).push(e) }), n }, E.sortedIndex = function (e, t, n) { n || (n = E.identity); for (var r = 0, i = e.length; r < i; ) { var s = r + i >> 1; n(e[s]) < n(t) ? r = s + 1 : i = s } return r }, E.toArray = function (e) { return e ? E.isArray(e) || E.isArguments(e) ? o.call(e) : e.toArray && E.isFunction(e.toArray) ? e.toArray() : E.values(e) : [] }, E.size = function (e) { return E.isArray(e) ? e.length : E.keys(e).length }, E.first = E.head = E.take = function (e, t, n) { return t != null && !n ? o.call(e, 0, t) : e[0] }, E.initial = function (e, t, n) { return o.call(e, 0, e.length - (t == null || n ? 1 : t)) }, E.last = function (e, t, n) { return t != null && !n ? o.call(e, Math.max(e.length - t, 0)) : e[e.length - 1] }, E.rest = E.tail = function (e, t, n) { return o.call(e, t == null || n ? 1 : t) }, E.compact = function (e) { return E.filter(e, function (e) { return !!e }) }, E.flatten = function (e, t) { return E.reduce(e, function (e, n) { return E.isArray(n) ? e.concat(t ? n : E.flatten(n)) : (e[e.length] = n, e) }, []) }, E.without = function (e) { return E.difference(e, o.call(arguments, 1)) }, E.uniq = E.unique = function (e, t, n) { var n = n ? E.map(e, n) : e, r = []; return e.length < 3 && (t = !0), E.reduce(n, function (n, i, s) { if (t ? E.last(n) !== i || !n.length : !E.include(n, i)) n.push(i), r.push(e[s]); return n }, []), r }, E.union = function () { return E.uniq(E.flatten(arguments, !0)) }, E.intersection = E.intersect = function (e) { var t = o.call(arguments, 1); return E.filter(E.uniq(e), function (e) { return E.every(t, function (t) { return E.indexOf(t, e) >= 0 }) }) }, E.difference = function (e) { var t = E.flatten(o.call(arguments, 1), !0); return E.filter(e, function (e) { return !E.include(t, e) }) }, E.zip = function () { for (var e = o.call(arguments), t = E.max(E.pluck(e, "length")), n = Array(t), r = 0; r < t; r++) n[r] = E.pluck(e, "" + r); return n }, E.indexOf = function (e, t, n) { if (e == null) return -1; var r; if (n) return n = E.sortedIndex(e, t), e[n] === t ? n : -1; if (g && e.indexOf === g) return e.indexOf(t); n = 0; for (r = e.length; n < r; n++) if (n in e && e[n] === t) return n; return -1 }, E.lastIndexOf = function (e, t) { if (e == null) return -1; if (y && e.lastIndexOf === y) return e.lastIndexOf(t); for (var n = e.length; n--; ) if (n in e && e[n] === t) return n; return -1 }, E.range = function (e, t, n) { arguments.length <= 1 && (t = e || 0, e = 0); for (var n = arguments[2] || 1, r = Math.max(Math.ceil((t - e) / n), 0), i = 0, s = Array(r); i < r; ) s[i++] = e, e += n; return s }; var T = function () { }; E.bind = function (e, t) { var n, r; if (e.bind === w && w) return w.apply(e, o.call(arguments, 1)); if (!E.isFunction(e)) throw new TypeError; return r = o.call(arguments, 2), n = function () { if (this instanceof n) { T.prototype = e.prototype; var i = new T, s = e.apply(i, r.concat(o.call(arguments))); return Object(s) === s ? s : i } return e.apply(t, r.concat(o.call(arguments))) } }, E.bindAll = function (e) { var t = o.call(arguments, 1); return t.length == 0 && (t = E.functions(e)), S(t, function (t) { e[t] = E.bind(e[t], e) }), e }, E.memoize = function (e, t) { var n = {}; return t || (t = E.identity), function () { var r = t.apply(this, arguments); return E.has(n, r) ? n[r] : n[r] = e.apply(this, arguments) } }, E.delay = function (e, t) { var n = o.call(arguments, 2); return setTimeout(function () { return e.apply(null, n) }, t) }, E.defer = function (e) { return E.delay.apply(E, [e, 1].concat(o.call(arguments, 1))) }, E.throttle = function (e, t) { var n, r, i, s, o, u, a = E.debounce(function () { o = s = !1 }, t); return function () { return n = this, r = arguments, i || (i = setTimeout(function () { i = null, o && e.apply(n, r), a() }, t)), s ? o = !0 : u = e.apply(n, r), a(), s = !0, u } }, E.debounce = function (e, t, n) { var r; return function () { var i = this, s = arguments; n && !r && e.apply(i, s), clearTimeout(r), r = setTimeout(function () { r = null, n || e.apply(i, s) }, t) } }, E.once = function (e) { var t = !1, n; return function () { return t ? n : (t = !0, n = e.apply(this, arguments)) } }, E.wrap = function (e, t) { return function () { var n = [e].concat(o.call(arguments, 0)); return t.apply(this, n) } }, E.compose = function () { var e = arguments; return function () { for (var t = arguments, n = e.length - 1; n >= 0; n--) t = [e[n].apply(this, t)]; return t[0] } }, E.after = function (e, t) { return e <= 0 ? t() : function () { if (--e < 1) return t.apply(this, arguments) } }, E.keys = b || function (e) { if (e !== Object(e)) throw new TypeError("Invalid object"); var t = [], n; for (n in e) E.has(e, n) && (t[t.length] = n); return t }, E.values = function (e) { return E.map(e, E.identity) }, E.functions = E.methods = function (e) { var t = [], n; for (n in e) E.isFunction(e[n]) && t.push(n); return t.sort() }, E.extend = function (e) { return S(o.call(arguments, 1), function (t) { for (var n in t) e[n] = t[n] }), e }, E.pick = function (e) { var t = {}; return S(E.flatten(o.call(arguments, 1)), function (n) { n in e && (t[n] = e[n]) }), t }, E.defaults = function (e) { return S(o.call(arguments, 1), function (t) { for (var n in t) e[n] == null && (e[n] = t[n]) }), e }, E.clone = function (e) { return E.isObject(e) ? E.isArray(e) ? e.slice() : E.extend({}, e) : e }, E.tap = function (e, t) { return t(e), e }, E.isEqual = function (t, n) { return e(t, n, []) }, E.isEmpty = function (e) { if (e == null) return !0; if (E.isArray(e) || E.isString(e)) return e.length === 0; for (var t in e) if (E.has(e, t)) return !1; return !0 }, E.isElement = function (e) { return !!e && e.nodeType == 1 }, E.isArray = s || function (e) { return a.call(e) == "[object Array]" }, E.isObject = function (e) { return e === Object(e) }, E.isArguments = function (e) { return a.call(e) == "[object Arguments]" }, E.isArguments(arguments) || (E.isArguments = function (e) { return !!e && !!E.has(e, "callee") }), E.isFunction = function (e) { return a.call(e) == "[object Function]" }, E.isString = function (e) { return a.call(e) == "[object String]" }, E.isNumber = function (e) { return a.call(e) == "[object Number]" }, E.isFinite = function (e) { return E.isNumber(e) && isFinite(e) }, E.isNaN = function (e) { return e !== e }, E.isBoolean = function (e) { return e === !0 || e === !1 || a.call(e) == "[object Boolean]" }, E.isDate = function (e) { return a.call(e) == "[object Date]" }, E.isRegExp = function (e) { return a.call(e) == "[object RegExp]" }, E.isNull = function (e) { return e === null }, E.isUndefined = function (e) { return e === void 0 }, E.has = function (e, t) { return f.call(e, t) }, E.noConflict = function () { return t._ = n, this }, E.identity = function (e) { return e }, E.times = function (e, t, n) { for (var r = 0; r < e; r++) t.call(n, r) }, E.escape = function (e) { return ("" + e).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;") }, E.result = function (e, t) { if (e == null) return null; var n = e[t]; return E.isFunction(n) ? n.call(e) : n }, E.mixin = function (e) { S(E.functions(e), function (t) { P(t, E[t] = e[t]) }) }; var N = 0; E.uniqueId = function (e) { var t = N++; return e ? e + t : t }, E.templateSettings = { evaluate: /<%([\s\S]+?)%>/g, interpolate: /<%=([\s\S]+?)%>/g, escape: /<%-([\s\S]+?)%>/g }; var C = /.^/, k = { "\\": "\\", "'": "'", r: "\r", n: "\n", t: "	", u2028: "\u2028", u2029: "\u2029" }, L; for (L in k) k[k[L]] = L; var A = /\\|'|\r|\n|\t|\u2028|\u2029/g, O = /\\(\\|'|r|n|t|u2028|u2029)/g, M = function (e) { return e.replace(O, function (e, t) { return k[t] }) }; E.template = function (e, t, n) { n = E.defaults(n || {}, E.templateSettings), e = "__p+='" + e.replace(A, function (e) { return "\\" + k[e] }).replace(n.escape || C, function (e, t) { return "'+\n_.escape(" + M(t) + ")+\n'" }).replace(n.interpolate || C, function (e, t) { return "'+\n(" + M(t) + ")+\n'" }).replace(n.evaluate || C, function (e, t) { return "';\n" + M(t) + "\n;__p+='" }) + "';\n", n.variable || (e = "with(obj||{}){\n" + e + "}\n"); var e = "var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n" + e + "return __p;\n", r = new Function(n.variable || "obj", "_", e); return t ? r(t, E) : (t = function (e) { return r.call(this, e, E) }, t.source = "function(" + (n.variable || "obj") + "){\n" + e + "}", t) }, E.chain = function (e) { return E(e).chain() }; var _ = function (e) { this._wrapped = e }; E.prototype = _.prototype; var D = function (e, t) { return t ? E(e).chain() : e }, P = function (e, t) { _.prototype[e] = function () { var e = o.call(arguments); return u.call(e, this._wrapped), D(t.apply(E, e), this._chain) } }; E.mixin(E), S("pop,push,reverse,shift,sort,splice,unshift".split(","), function (e) { var t = i[e]; _.prototype[e] = function () { var n = this._wrapped; t.apply(n, arguments); var r = n.length; return (e == "shift" || e == "splice") && r === 0 && delete n[0], D(n, this._chain) } }), S(["concat", "join", "slice"], function (e) { var t = i[e]; _.prototype[e] = function () { return D(t.apply(this._wrapped, arguments), this._chain) } }), _.prototype.chain = function () { return this._chain = !0, this }, _.prototype.value = function () { return this._wrapped } } .call(this), h.prototype = new gg7.gg6, h.prototype.gg6_initialize = h.prototype.initialize, h.prototype.initialize = function (e, n) { this.gg6_initialize(); var r = t.getBitmap("shadowmap"); r.regX = 25, r.regY = 40, this.name = e, r.gkk3 = new gg7.fcnaaf(128, 64, 64, 64), this.adcg1(r), r = new gg7.gg5(t.getJSON(e)), gg7.gg5Utils.addFlippedFrames(r, !0, !1, !1), this.bmpAnim = new gg7.gg8(r), this.currentCell = n, this.x = n.x * 64 + 32, this.y = n.y * 64 + 32, this.speed = 2, this.dir = 3, this.stand(), this.adcg1(this.bmpAnim), this.path = [], gg7.gg2.addListener(this), this.attackCD = !0, this.cdTime = 0, this.aabb = new l(this.x - 16, this.y - 26, 32, 50), this.debuggerRect = new gg7.Shape; var i = this; this.bmpAnim.onAnimationEnd = function () { this.gg9.indexOf("attack") != -1 && (i.speed = 2, i.walk()) } }, h.prototype.tick = function () { this.debuggerRect.graphics.clear(), this.debuggerRect.graphics.beginStroke("#F00").drawRect(-16, -26, this.aabb.width, this.aabb.height), !this.attackCD && (this.cdTime += 1e3 / gg7.gg2.getMeasuredFPS(), this.cdTime > 2e3) && (this.cdTime = 0, this.attackCD = !0); if (this.bmpAnim.gg9.indexOf("attack") != -1) this.speed = 0; else if (this.path.length > 0) { var e = this.path[0], e = new Vector2(e[0], e[1]), t = new Vector2(e.x * 64 + 32, e.y * 64 + 32), n = t.sub(new Vector2(this.x, this.y)).setLength(this.speed); this.setDirection(e), this.walk(), this.x += n.x, this.y += n.y, this.aabb = new l(this.x - 16, this.y - 26, 32, 50); if ((new Vector2(this.x, this.y)).distanceToSquared(t) < 25 || n.x === 0 && n.y === 0) if (this.path.shift(), this.currentCell = new Vector2(parseInt(this.x / 64), parseInt(this.y / 64)), this.path.length === 0) this.path = this.currentCell.y === this.pathBak[0][1] && this.currentCell.x === this.pathBak[0][0] ? _(this.pathBak).clone() : _(this.pathBak).clone().reverse() } else this.stand() }, h.prototype.setDirection = function (e) { var t = e.x - this.currentCell.x, e = e.y - this.currentCell.y; t === 0 && e < 0 && (this.dir = 1), t > 0 && e === 0 && (this.dir = 2), t === 0 && e > 0 && (this.dir = 3), t < 0 && e === 0 && (this.dir = 4) }, h.prototype.walk = function () { this.bmpAnim.gg9 != "walk" + this.getFrameName() && this.bmpAnim.gg1("walk" + this.getFrameName()) }, h.prototype.stand = function () { this.bmpAnim.gg9 != "stand" + this.getFrameName() && this.bmpAnim.gg1("stand" + this.getFrameName()) }, h.prototype.win = function () { this.bmpAnim.gg9 != "win" && this.bmpAnim.gg1("win") }, h.prototype.getFrameName = function () { if (this.dir == 1) return "1"; if (this.dir == 2) return "4_h"; if (this.dir == 3) return "3"; if (this.dir == 4) return "4" }, h.prototype.attack = function () { this.bmpAnim.gg9 != "attack" + this.getFrameName() && this.bmpAnim.gg1("attack" + this.getFrameName()) }, p.prototype = new gg7.gg6, p.prototype.gg6_initialize = p.prototype.initialize, p.prototype.initialize = function () { this.gg6_initialize(); var e = t.getBitmap("bg1"), n = t.getBitmap("bg2"); e.x = 55, n.x = e.x + e.image.width, this.adcg1(e, n); for (e = 0; e < 64; e++) n = e + 1 > 4 ? new d(e + 1, !0) : new d(e + 1), n.x = 64 * (e % 8) + 240, n.y = 64 * Math.floor(e / 8) + 100, this.adcg1(n) }, d
.prototype = new gg7.gg6, d.prototype.gg6_initialize = d.prototype.initialize, d.prototype.initialize = function (e, n) { this.gg6_initialize(); var r = t.getBitmap("ButtonBase0"); r.regX = r.image.width / 2, r.regY = r.image.height / 2; var i = t.getBitmap("levelnumbers"); i.gkk3 = new gg7.fcnaaf(32 * ((e - 1) % 8), 32 * Math.floor((e - 1) / 8), 32, 32), i.regX = 16, i.regY = 16; var s = t.getBitmap("padlock"); s.regX = s.image.width / 2, s.regY = s.image.height / 2, this.adcg1(r, i), n ? this.adcg1(s) : this.onClick = function () { a.currentLevel = e, a.curtain.close(function () { a.curtain.open(), a.loadLevel(e), a.levelPanel.visible = !1 }) } }, v.prototype = new gg7.gg6, v.prototype.gg6_initialize = v.prototype.initialize, v.prototype.initialize = function () { this.gg6_initialize(), this.imageLoaded = !1; var e = this, t = new Image; t.onload = function () { e.imageLoaded = !0; var n = new gg7.gg5({ images: [t], frames: { width: 960, height: 640, regX: 0, regY: 0 }, animations: { close: [0, 8, "", 2], open: [9, 17, "", 2]} }); e.bmpAnim = new gg7.gg8(n), e.adcg1(e.bmpAnim) }, t.src = "assets/other/curtains960.gif" }, v.prototype.open = function (e) { this.imageLoaded ? (this.bmpAnim.onAnimationEnd = function () { e && e(), a.curtain.visible = !1 }, this.bmpAnim.gg9 != "open" && this.bmpAnim.gg1("open")) : (a.curtain.visible = !1, e && e()) }, v.prototype.close = function (e) { this.imageLoaded ? (a.curtain.visible = !0, this.bmpAnim.onAnimationEnd = e, this.bmpAnim.gg9 != "close" && this.bmpAnim.gg1("close")) : (a.curtain.visible = !0, e && e()) }, m.prototype = new gg7.gg6, m.prototype.gg6_initialize = m.prototype.initialize, m.prototype.initialize = function (e, n) { this.gg6_initialize(); var r = new gg7.gg5({ images: [t.getRes("axe")], frames: { width: 32, height: 32, numFrames: 6, regX: 16, regY: 16 }, animations: { fly1: [0, 3, "fly1", 5], fly2: [4, 5, "fly2", 5]} }); this.bmpAnim = new gg7.gg8(r), this.bmpAnim.gg1("fly1"), this.adcg1(this.bmpAnim), this.dir = n, this.x = e.x, this.y = e.y, this.speed = 4, this.adcg1(this.bmpAnim), gg7.gg2.addListener(this) }, m.prototype.tick = function () { this.dir == 1 && (this.fly2(), this.y -= this.speed), this.dir == 2 && (this.fly1(), this.x += this.speed), this.dir == 3 && (this.fly2(), this.y += this.speed), this.dir == 4 && (this.fly1(), this.x -= this.speed); if (Math.abs(this.x) > 2e3 || Math.abs(this.y) > 2e3) gg7.gg2.gg3(this), this.parent.gg4(this); if ((new Vector2(this.x, this.y)).distanceToSquared(new Vector2(a.player.x, a.player.y)) <= 100) { gg7.gg2.gg3(this), this.parent.gg4(this); for (var e = 0; e < a.enemys.length; e++) gg7.gg2.gg3(a.player), gg7.gg2.gg3(a.enemys[e]), a.enemys[e].speed = 0, a.enemys[e].win(), a.showLose(), a.player.lose() } }, m.prototype.fly1 = function () { this.bmpAnim.gg9 != "fly1" && this.bmpAnim.gg1("fly1") }, m.prototype.fly2 = function () { this.bmpAnim.gg9 != "fly2" && this.bmpAnim.gg1("fly2") };