function lb(n,t){this.initialize(n,t)}function main(){var n=new PxLoader;obaImage=n.addImage("loader-bubble.png"),mbi=n.addImage("menubg.jpg"),lgi=n.addImage("loader-logo.png"),sim=n.addImage("loader-smallbubble.png"),n.addCompletionListener(function(){init()}),n.start()}function grn(n,t){return n+Math.floor(Math.random()*(t-n+1))}function filter(){for(var u,i,r,t,f,n=0;n<20;n++)u={position:new Vector2(grn(63,370),grn(63,370)),r:62,vx:grn(-200,200),vy:grn(-200,200)},bls.push(u);for(i=[],n=0;n<bls.length;n++){for(r=0,t=n+1;t<bls.length;t++)f=bls[n].position.distanceTo(bls[t].position),f<=bls[n].r+bls[t].r&&r++;r===0&&i.push(bls[n])}bls=i}function init(){var i,t,n;cv=document.getElementById("testCanvas"),stage=new Stage(cv),cvWidth=cv.width,cvHeight=cv.height,menubgBmp=new Bitmap(mbi),logoBmp=new Bitmap(lgi),logoBmp.x=170,logoBmp.y=120,stage.addChild(menubgBmp),stage.addChild(logoBmp),lb=new lb(new Vector2(1,1),obaImage),stage.addChild(lb),smallBubble=new Bitmap(sim),stage.addChild(bubc),filter();for(i in bls)t=new Bitmap(sim),t.regX=61,t.regY=61,n=new Container,n.addChild(t),n.x=bls[i].position.x,n.y=bls[i].position.y,bubc.addChild(n);stage.addChild(sbc),Ticker.setFPS(60),Ticker.addListener(window)}function tick(){for(var t,f,s,i,n=0;n<bls.length;n++)for(t=n+1;t<bls.length;t++)if(f=bls[n].position.distanceTo(bls[t].position),f<bls[n].r+bls[t].r){var r=(bls[n].position.x-bls[t].position.x)/f,u=(bls[n].position.y-bls[t].position.y)/f,e=bls[n].vx*r*r+bls[n].vy*u*r-bls[t].vx*r*r-bls[t].vy*u*r,o=bls[n].vx*r*u+bls[n].vy*u*u-bls[t].vx*r*u-bls[t].vy*u*u;bls[t].vx+=e,bls[t].vy+=o,bls[n].vx-=e,bls[n].vy-=o,bls[n].position.x+=(bls[n].r+bls[t].r-f)*r,bls[n].position.y+=(bls[n].r+bls[t].r-f)*u}for(n in bls)bls[n].position.x<180&&(bls[n].vy-=20),bubc.children[n].x=bls[n].position.x,bubc.children[n].y=bls[n].position.y,bls[n].r+bls[n].position.x>cv.width&&(bls[n].position.x=cv.width-bls[n].r,bls[n].vx*=-1),bls[n].position.x<bls[n].r&&(bls[n].position.x=bls[n].r,bls[n].vx*=-1),bls[n].r+bls[n].position.y>cv.height&&(bls[n].position.y=cv.height-bls[n].r,bls[n].vy*=-1),bls[n].position.y<bls[n].r&&(bls[n].position.y=bls[n].r,bls[n].vy*=-1),bls[n].position.x+=bls[n].vx*15/1e3,bls[n].position.y+=bls[n].vy*15/1e3;for(s=sbc.getNumChildren(),n=s-1;n>0;n--)i=sbc.getChildAt(n),i.vX*=.6,i.x+=i.vX,i.y-=i.vY,i.alpha+=i.vA,(i.alpha<=0||i.y>cv.height)&&sbc.removeChildAt(n);stage.update(),ab(15,1),stage.update()}function ab(n,t){for(var i,u,f,r=0;r<n;r++)i=smallBubble.clone(),i.x=100,i.y=435,i.alpha=Math.random()*.5+.5,u=Math.PI*2*Math.random(),f=Math.random()*15*t,i.vX=Math.cos(u)*f,i.vY=Math.sin(u)*f,i.scaleX=i.scaleY=.2,i.vS=(Math.random()-.5)*.2,i.vA=-Math.random()*.05-.01,sbc.addChild(i)}var cv,cvWidth,cvHeight,stage,bmp,menubgBmp,logoBmp,lgi,obaImage,mbi,sim,bls,bubc,sbc,lb,smallBubble;lb.prototype=new Container,lb.prototype.Container_initialize=lb.prototype.initialize,lb.prototype.initialize=function(n,t){this.Container_initialize(),this.v=n,bmp=new Bitmap(t),bmp.regX=t.width/2,bmp.regY=t.height/2,this.r=98,this.addChild(bmp),this.x=200,this.y=200,this.pc=0,this.lt=new Text(this.pc+"%","60px bold Arial","#fff"),this.lt.x=-45,this.lt.y=20,this.addChild(this.lt)},lb.prototype.tick=function(){this.x+=this.v.x,this.y+=this.v.y,(this.y+this.r>=cvHeight||this.y<=this.r)&&(this.v.y*=-1),(this.x+this.r>=cvWidth||this.x<=this.r)&&(this.v.x*=-1),this.pc+=.01,this.pc>100&&(this.pc=100),this.lt.text=this.pc<9.5?"0"+Math.round(this.pc)+"%":Math.round(this.pc)+"%"},bls=[],bubc=new Container,sbc=new Container,main()