define(function(){var n=function(n,t,i){this.initialize(n,t,i)};return n.prototype=new CJ.Container,n.prototype.Container_initialize=n.prototype.initialize,n.prototype.initialize=function(n,t,i){var u,r;this.Container_initialize(),this.name=t,this.player=n,this.position=i;var f=Resource.getFrames(t),e={frames:f,animations:{show:[0,f.length-2,"",5]},images:[Resource.getRes(t)]},o=new CJ.SpriteSheet(e);for(this.prePositionX=-1,this.prePositionY=-1,this.preViewPortX=Global.player.viewPort[0],this.preViewPortY=Global.player.viewPort[1],this.setStagePosition(),this.animation=new CJ.BitmapAnimation(o),this.animation.gotoAndPlay("show"),this.addChild(this.animation),CJ.Ticker.addListener(this),u=this,r=0;r<Global.enemyArr.length;r++)Global.enemyArr[r].position.distanceToSquared(u.position)<1e4&&Global.enemyArr[r].HP>0&&(Global.enemyArr[r].target=this.player,Global.enemyArr[r].subHP(MathHelp.getRandomNumber(30,40)));this.animation.onAnimationEnd=function(){u.destroy()}},n.prototype.tick=function(){this.setStagePosition()},n.prototype.destroy=function(){this.animation!=null&&this.animation.stop(),CJ.Ticker.removeListener(this),this.removeAllChildren(),Global.PGCTT.removeChild(this)},n.prototype.setStagePosition=function(){if((this.preViewPortX!==Global.player.viewPort[0]||this.preViewPortY!==Global.player.viewPort[1])&&(this.x+=this.preViewPortX-Global.player.viewPort[0],this.y+=this.preViewPortY-Global.player.viewPort[1],this.preViewPortX=Global.player.viewPort[0],this.preViewPortY=Global.player.viewPort[1]),this.prePositionX!==this.position.x||this.prePositionY!==this.position.y){var n=Global.worldToStage(this.position);this.x=parseInt(n.x),this.y=parseInt(n.y),this.prePositionX=this.position.x,this.prePositionY=this.position.y}},n})